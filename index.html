<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Thruver — Infraestructura confiable de mantenimiento y mejoras</title>
  <meta name="description" content="Thruver conecta tu espacio con técnicos verificados, asignados por zona." />
  <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/tny-me/thruver.github.io/main/Favicon.png" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg:      #f3f3f3;
      --bg2:     #eaeaea;
      --bg3:     #e0e0e0;
      --white:   #ffffff;
      --black:   #111111;
      --text:    #111111;
      --muted:   #777777;
      --muted2:  #aaaaaa;
      --border:  rgba(0,0,0,0.08);
      --radius:  14px;
      --rsm:     8px;
      --font:    Arial, "Arial Unicode MS", sans-serif;
    }

    html { scroll-behavior: smooth; }

    body {
      font-family: var(--font);
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      overflow-x: hidden;
    }

    /* ══ NAV ══ */
    nav {
      position: fixed; top: 0; left: 0; right: 0; z-index: 300;
      height: 60px; display: flex; align-items: center;
      justify-content: space-between; padding: 0 2.5rem;
      background: var(--bg); border-bottom: 1px solid var(--border);
    }
    .nav-logo { font-weight: 900; font-size: 1.3rem; letter-spacing: -0.04em; color: var(--black); text-decoration: none; }
    .nav-center { display: flex; gap: 0.2rem; list-style: none; }
    .nav-center a { color: var(--muted); text-decoration: none; font-size: 0.85rem; padding: 0.4rem 0.85rem; border-radius: 6px; transition: color 0.15s, background 0.15s; }
    .nav-center a:hover { color: var(--black); background: var(--bg3); }
    .nav-right { display: flex; gap: 0.5rem; align-items: center; }

    .btn-ghost {
      background: transparent; color: var(--text); border: 1px solid var(--border);
      padding: 0.42rem 1rem; border-radius: var(--rsm); font-size: 0.83rem;
      cursor: pointer; font-family: var(--font); text-decoration: none;
      min-height: 44px; display: inline-flex; align-items: center;
      transition: border-color 0.15s, background 0.15s;
    }
    .btn-ghost:hover { border-color: rgba(0,0,0,0.18); background: var(--bg2); }

    .btn-solid {
      background: var(--black); color: var(--white) !important; border: none;
      padding: 0.48rem 1.1rem; border-radius: var(--rsm); font-size: 0.83rem;
      font-weight: 700; cursor: pointer; font-family: var(--font);
      text-decoration: none; min-height: 44px; display: inline-flex;
      align-items: center; transition: opacity 0.15s;
    }
    .btn-solid:hover { opacity: 0.78; }

    .nav-hamburger {
      display: none; flex-direction: column; justify-content: center;
      align-items: center; gap: 5px; width: 44px; height: 44px;
      background: transparent; border: 1px solid var(--border);
      border-radius: var(--rsm); cursor: pointer;
    }
    .nav-hamburger span { display: block; width: 20px; height: 2px; background: var(--black); border-radius: 2px; transition: all 0.25s ease; }
    .nav-hamburger.open span:nth-child(1) { transform: translateY(7px) rotate(45deg); }
    .nav-hamburger.open span:nth-child(2) { opacity: 0; transform: scaleX(0); }
    .nav-hamburger.open span:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }

    .mobile-menu {
      display: none; position: fixed; top: 60px; left: 0; right: 0; bottom: 0;
      z-index: 250; background: var(--white); padding: 1.2rem 1.5rem 2rem;
      flex-direction: column; gap: 0.2rem; overflow-y: auto;
      animation: slideDown 0.22s ease;
    }
    .mobile-menu.open { display: flex; }
    @keyframes slideDown { from{opacity:0;transform:translateY(-8px)} to{opacity:1;transform:translateY(0)} }
    .mobile-menu a { display: flex; align-items: center; padding: 0.9rem 1rem; font-size: 0.97rem; font-weight: 600; color: var(--text); text-decoration: none; border-radius: var(--radius); min-height: 52px; transition: background 0.15s; }
    .mobile-menu a:active { background: var(--bg); }
    .mm-divider { height: 1px; background: var(--border); margin: 0.5rem 0; }
    .mm-cta { display: flex; flex-direction: column; gap: 0.6rem; margin-top: 0.4rem; }
    .mm-cta .btn-solid,
    .mm-cta .btn-ghost { width: 100%; justify-content: center; font-size: 0.95rem; padding: 0.85rem; border-radius: var(--radius); }
    /* FIX: Asegurar que el texto del botón solicitar servicio sea blanco en el menú móvil */
    .mm-cta .btn-solid { background: var(--black) !important; color: #ffffff !important; }

    /* ══ HERO ══ */
    .hero {
      margin-top: 60px; min-height: calc(100vh - 60px);
      display: grid; grid-template-columns: 1fr 1fr;
      align-items: center; position: relative; overflow: hidden; background: var(--bg);
    }
    .hero-grid-pattern {
      position: absolute; inset: 0;
      background-image: linear-gradient(rgba(0,0,0,0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(0,0,0,0.05) 1px, transparent 1px);
      background-size: 48px 48px; pointer-events: none; z-index: 0;
      animation: gridBreathe 6s ease-in-out infinite;
    }
    @keyframes gridBreathe { 0%,100%{transform:scale(1);opacity:1} 50%{transform:scale(1.06);opacity:0.5} }
    @media(prefers-reduced-motion:reduce){ .hero-grid-pattern{animation:none} }
    .hero-left { position: relative; z-index: 1; padding: 5rem 3rem 5rem 4rem; display: flex; flex-direction: column; }
    .hero-badge { display: inline-flex; align-items: center; gap: 0.45rem; background: var(--white); border: 1px solid var(--border); color: var(--muted); font-size: 0.74rem; padding: 0.34rem 0.9rem; border-radius: 100px; margin-bottom: 2rem; width: fit-content; box-shadow: 0 1px 4px rgba(0,0,0,0.05); animation: fadeUp 0.5s ease both; }
    .badge-dot { width: 6px; height: 6px; border-radius: 50%; background: #22c55e; animation: pulse 2s infinite; flex-shrink: 0; }
    @keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:.4;transform:scale(.8)} }
    .hero-h1 { font-weight: 900; font-size: clamp(1.9rem, 3.2vw, 2.65rem); letter-spacing: -0.04em; line-height: 1.08; color: var(--black); margin-bottom: 1.2rem; animation: fadeUp 0.5s ease 0.07s both; }
    .hero-sub { font-size: 0.95rem; color: var(--muted); line-height: 1.75; max-width: 400px; margin-bottom: 2.2rem; animation: fadeUp 0.5s ease 0.14s both; }
    .hero-actions { display: flex; gap: 0.6rem; flex-wrap: wrap; margin-bottom: 3rem; animation: fadeUp 0.5s ease 0.21s both; }
    .hero-actions .btn-solid { padding: 0.72rem 1.6rem; font-size: 0.88rem; }
    .hero-actions .btn-ghost { padding: 0.72rem 1.6rem; font-size: 0.88rem; background: var(--white); border-color: var(--white); }
    .hero-actions .btn-ghost:hover { background: var(--bg3); border-color: var(--bg3); }
    .hero-stats { display: flex; background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; width: fit-content; box-shadow: 0 2px 12px rgba(0,0,0,0.04); animation: fadeUp 0.5s ease 0.28s both; }
    .hero-stat { padding: 1.1rem 1.4rem; border-right: 1px solid var(--border); text-align: center; }
    .hero-stat:last-child { border-right: none; }
    .hero-stat strong { display: block; font-size: 1.3rem; font-weight: 900; color: var(--black); letter-spacing: -0.03em; }
    .hero-stat span   { font-size: 0.68rem; color: var(--muted2); text-transform: uppercase; letter-spacing: 0.08em; }
    @keyframes fadeUp { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:translateY(0)} }

    .hero-right { position: relative; z-index: 1; height: calc(100vh - 60px); display: flex; align-items: center; justify-content: center; padding: 3rem 3.5rem 3rem 1.5rem; }
    .carousel-wrap { width: 100%; max-width: 500px; }
    .carousel-frame { width: 100%; aspect-ratio: 4/3; border-radius: 20px; overflow: hidden; border: 1px solid rgba(0,0,0,0.09); box-shadow: 0 24px 64px rgba(0,0,0,0.13), 0 4px 16px rgba(0,0,0,0.06); background: var(--bg3); animation: fadeUp 0.6s ease 0.1s both; }
    .carousel-slides { display: flex; width: 100%; height: 100%; transition: transform 0.9s cubic-bezier(0.4,0,0.2,1); }
    .carousel-slide { flex-shrink: 0; width: 100%; height: 100%; overflow: hidden; }
    .carousel-slide img { width: 100%; height: 100%; object-fit: cover; display: block; transition: transform 6s ease; transform: scale(1.06); }
    .carousel-slide.active img { transform: scale(1); }
    .carousel-dots { display: flex; gap: 0.45rem; justify-content: center; margin-top: 1rem; }
    .carousel-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--bg3); transition: background 0.3s, transform 0.3s; cursor: pointer; position: relative; }
    .carousel-dot::after { content: ''; position: absolute; inset: -8px; }
    .carousel-dot.active { background: var(--black); transform: scale(1.4); }

    /* ══ SERVICES BAR ══ */
    .services-bar { background: #3c3c3c; }
    .services-bar-inner { max-width: 1140px; margin: 0 auto; padding: 2.5rem; }
    .services-bar-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.4rem; }
    .services-bar h2 { font-weight: 900; font-size: 1.05rem; letter-spacing: -0.03em; color: var(--white); }
    .link-muted { font-size: 0.8rem; color: rgba(255,255,255,0.45); text-decoration: none; transition: color 0.15s; }
    .link-muted:hover { color: var(--white); }
    .services-grid { display: grid; grid-template-columns: repeat(8, 1fr); gap: 0.7rem; }
    .service-pill { background: var(--bg); border: 1px solid var(--border); border-radius: var(--radius); padding: 1.2rem 0.6rem; text-align: center; cursor: pointer; text-decoration: none; color: var(--text); display: flex; flex-direction: column; align-items: center; gap: 0.4rem; min-height: 80px; transition: all 0.18s; }
    .service-pill:hover { background: var(--bg3); transform: translateY(-2px); box-shadow: 0 4px 14px rgba(0,0,0,0.06); }
    .service-pill-icon  { font-size: 1.6rem; }
    .service-pill-label { font-size: 0.72rem; font-weight: 700; }

    /* ══ MAIN CONTENT ══ */
    .main-content { max-width: 1140px; margin: 0 auto; padding: 4rem 2.5rem; display: grid; grid-template-columns: 1.1fr 0.9fr; gap: 2rem; align-items: start; }
    .main-left, .main-right { display: flex; flex-direction: column; gap: 1.2rem; }
    .eyebrow { font-size: 0.68rem; font-weight: 700; color: var(--muted2); text-transform: uppercase; letter-spacing: 0.12em; margin-bottom: 0.3rem; }
    .block-title { font-size: 1.35rem; font-weight: 900; letter-spacing: -0.035em; line-height: 1.15; color: var(--black); margin-bottom: 0.8rem; }
    .problem-grid { display: flex; flex-direction: column; gap: 0.7rem; }
    .problem-card { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); padding: 1.3rem 1.5rem; display: flex; align-items: flex-start; gap: 1rem; transition: transform 0.18s, box-shadow 0.18s; }
    .problem-card:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.06); }
    .problem-icon { font-size: 1.3rem; flex-shrink: 0; width: 38px; height: 38px; background: var(--bg); border-radius: 8px; display: flex; align-items: center; justify-content: center; }
    .problem-card h3 { font-size: 0.87rem; font-weight: 700; margin-bottom: 0.2rem; }
    .problem-card p  { font-size: 0.79rem; color: var(--muted); line-height: 1.65; }
    .how-block { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; }
    .block-tabs { display: flex; border-bottom: 1px solid var(--border); }
    .block-tab { flex: 1; padding: 0.8rem; font-size: 0.81rem; cursor: pointer; border: none; background: transparent; color: var(--muted); font-family: var(--font); transition: all 0.15s; border-bottom: 2px solid transparent; margin-bottom: -1px; min-height: 48px; }
    .block-tab.active { color: var(--black); font-weight: 700; border-bottom-color: var(--black); background: var(--bg); }
    .tab-panel { display: none; padding: 1.1rem; flex-direction: column; gap: 0.55rem; }
    .tab-panel.active { display: flex; }
    .how-step { display: flex; gap: 0.9rem; align-items: flex-start; padding: 0.85rem 0.9rem; background: var(--bg); border-radius: var(--rsm); border: 1px solid var(--border); transition: transform 0.15s; }
    .how-step:hover { transform: translateX(2px); }
    .step-num { font-size: 1rem; font-weight: 900; color: var(--bg3); width: 24px; flex-shrink: 0; padding-top: 1px; }
    .how-step h3 { font-size: 0.82rem; font-weight: 700; margin-bottom: 0.15rem; }
    .how-step p  { font-size: 0.77rem; color: var(--muted); line-height: 1.6; }
    .why-card { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); padding: 1.4rem 1.6rem; transition: transform 0.18s, box-shadow 0.18s; position: relative; overflow: hidden; }
    .why-card::after { content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 3px; background: var(--black); }
    .why-card:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.06); }
    .why-card h3 { font-size: 0.87rem; font-weight: 700; margin-bottom: 0.3rem; }
    .why-card p  { font-size: 0.79rem; color: var(--muted); line-height: 1.65; }
    .why-card-dark { background: var(--black); border-color: transparent; }
    .why-card-dark::after { background: rgba(255,255,255,0.15); }
    .why-card-dark h3 { color: var(--white); }
    .why-card-dark p  { color: rgba(255,255,255,0.45); }
    .why-card-icon { font-size: 1.7rem; margin-bottom: 0.7rem; }
    .why-2col { display: grid; grid-template-columns: 1fr 1fr; gap: 0.7rem; }
    .register-block { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.65rem; }
    .form-group { margin-bottom: 0.7rem; }
    .form-group label { display: block; font-size: 0.67rem; font-weight: 700; color: var(--muted); margin-bottom: 0.26rem; text-transform: uppercase; letter-spacing: 0.07em; }
    .form-group input, .form-group select { width: 100%; background: var(--bg); border: 1px solid var(--border); border-radius: var(--rsm); padding: 0.7rem 0.85rem; color: var(--text); font-size: 1rem; font-family: var(--font); outline: none; min-height: 48px; -webkit-appearance: none; transition: border-color 0.15s, background 0.15s; }
    .form-group input::placeholder { color: var(--muted2); }
    .form-group input:focus, .form-group select:focus { border-color: var(--black); background: var(--white); }
    .register-form-panel { display: none; padding: 1.3rem 1.4rem; }
    .register-form-panel.active { display: block; }
    .btn-submit { width: 100%; background: var(--black); color: var(--white) !important; border: none; padding: 0.9rem; border-radius: var(--rsm); font-size: 0.9rem; font-weight: 700; cursor: pointer; font-family: var(--font); min-height: 52px; display: flex; align-items: center; justify-content: center; gap: 0.5rem; transition: all 0.18s; margin-top: 0.2rem; }
    .btn-submit:hover { opacity: 0.78; transform: translateY(-1px); }
    .btn-submit:disabled { opacity: 0.45; cursor: not-allowed; transform: none; }
    .spinner { display: none; width: 14px; height: 14px; border: 2px solid rgba(255,255,255,0.3); border-top-color: #fff; border-radius: 50%; animation: spin 0.7s linear infinite; }
    @keyframes spin { to{transform:rotate(360deg)} }
    .form-note { font-size: 0.67rem; color: var(--muted2); margin-top: 0.5rem; text-align: center; }
    .success-msg { display: none; text-align: center; padding: 2rem 1rem; }
    .success-msg .check { font-size: 1.8rem; margin-bottom: 0.6rem; }
    .success-msg h4 { font-size: 0.95rem; font-weight: 700; margin-bottom: 0.3rem; }
    .success-msg p  { font-size: 0.79rem; color: var(--muted); }

    /* ══ WHY STRIP ══ */
    .why-strip { background: var(--white); border-bottom: 1px solid var(--border); }
    .why-strip-inner { max-width: 1140px; margin: 0 auto; padding: 5rem 2.5rem; display: grid; grid-template-columns: 1fr 1fr; gap: 5rem; align-items: center; }
    .why-strip-eyebrow { font-size: 0.68rem; font-weight: 700; color: var(--muted2); text-transform: uppercase; letter-spacing: 0.13em; margin-bottom: 0.5rem; }
    .why-strip-title { font-size: clamp(1.5rem, 3vw, 2rem); font-weight: 900; letter-spacing: -0.04em; line-height: 1.1; color: var(--black); margin-bottom: 2.5rem; }
    .why-strip-list { display: flex; flex-direction: column; gap: 1.5rem; }
    .why-strip-item { display: flex; gap: 1rem; align-items: flex-start; }
    .why-strip-icon { width: 38px; height: 38px; border-radius: 9px; background: var(--bg); border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; font-size: 1.1rem; flex-shrink: 0; margin-top: 1px; }
    .why-strip-item-text strong { display: block; font-size: 0.88rem; font-weight: 700; color: var(--black); margin-bottom: 0.2rem; }
    .why-strip-item-text p { font-size: 0.82rem; color: var(--muted); line-height: 1.7; }
    .why-strip-item-text p b { color: var(--black); font-weight: 700; }
    .why-strip-right { display: flex; align-items: center; justify-content: center; }
    .why-badge-card { background: #0098cf; border-radius: 24px; padding: 3.5rem 3rem; text-align: center; width: 100%; max-width: 340px; box-shadow: 0 8px 40px rgba(0,152,207,0.25); }
    .why-badge-icon { width: 96px; height: 96px; margin: 0 auto 2rem; display: flex; align-items: center; justify-content: center; }
    .why-badge-card h3 { font-size: 1.15rem; font-weight: 900; color: #000; letter-spacing: -0.03em; margin-bottom: 0.5rem; white-space: nowrap; }
    .why-badge-card p { font-size: 0.82rem; color: rgba(255,255,255,0.75); line-height: 1.65; }

    /* ══ FOOTER ══ */
    footer { background: var(--white); border-top: 1px solid var(--border); padding: 2rem 2.5rem; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 1rem; }
    .footer-logo { font-weight: 900; font-size: 1.1rem; letter-spacing: -0.04em; color: var(--black); }
    .footer-links { display: flex; gap: 1.5rem; flex-wrap: wrap; }
    .footer-links a { font-size: 0.78rem; color: var(--muted); text-decoration: none; min-height: 44px; display: inline-flex; align-items: center; transition: color 0.15s; }
    .footer-links a:hover { color: var(--black); }
    .footer-copy { font-size: 0.7rem; color: var(--muted2); }

    /* ══ LOGIN MODAL ══ */
    .modal-overlay { display: none; position: fixed; inset: 0; z-index: 1000; background: rgba(0,0,0,0.45); backdrop-filter: blur(6px); align-items: center; justify-content: center; }
    .modal-overlay.open { display: flex; animation: fadeIn 0.2s ease; }
    @keyframes fadeIn { from{opacity:0} to{opacity:1} }
    .modal-box { background: var(--white); border-radius: 18px; padding: 2.5rem; width: 100%; max-width: 380px; margin: 1rem; box-shadow: 0 24px 80px rgba(0,0,0,0.18); animation: slideUp 0.25s ease; position: relative; }
    @keyframes slideUp { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
    .modal-box h2 { font-size: 1.3rem; font-weight: 900; letter-spacing: -0.03em; color: var(--black); margin-bottom: 0.3rem; }
    .modal-box .modal-sub { font-size: 0.8rem; color: var(--muted); margin-bottom: 1.8rem; }
    .modal-close { position: absolute; top: 1rem; right: 1rem; background: var(--bg); border: none; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; font-size: 1rem; display: flex; align-items: center; justify-content: center; color: var(--muted); transition: background 0.15s; }
    .modal-close:hover { background: var(--bg3); }
    .modal-error { display: none; background: #fff0f0; border: 1px solid #fcc; border-radius: 7px; padding: 0.6rem 0.9rem; font-size: 0.78rem; color: #cc3333; margin-bottom: 0.8rem; }

    /* ══ DASHBOARD ══ */
    #dashboard { display: none; min-height: 100vh; background: var(--bg); padding-top: 60px; }
    .dash-nav { position: fixed; top: 0; left: 0; right: 0; z-index: 200; height: 60px; display: flex; align-items: center; justify-content: space-between; padding: 0 2.5rem; background: var(--white); border-bottom: 1px solid var(--border); }
    .dash-nav-logo { font-weight: 900; font-size: 1.3rem; letter-spacing: -0.04em; color: var(--black); text-decoration: none; }
    .dash-nav-right { display: flex; align-items: center; gap: 1rem; }
    .dash-user { display: flex; align-items: center; gap: 0.6rem; font-size: 0.83rem; color: var(--text); }
    .dash-avatar { width: 32px; height: 32px; border-radius: 50%; background: var(--black); color: var(--white); display: flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: 700; flex-shrink: 0; }
    .dash-body { max-width: 1100px; margin: 0 auto; padding: 2.5rem; }
    .dash-greeting { margin-bottom: 2rem; }
    .dash-greeting h1 { font-size: 1.6rem; font-weight: 900; letter-spacing: -0.04em; color: var(--black); margin-bottom: 0.2rem; }
    .dash-greeting p  { font-size: 0.85rem; color: var(--muted); }
    .dash-stats { display: grid; grid-template-columns: repeat(4,1fr); gap: 1rem; margin-bottom: 2rem; }
    .dash-stat-card { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); padding: 1.3rem 1.5rem; }
    .dash-stat-label { font-size: 0.7rem; font-weight: 700; color: var(--muted2); text-transform: uppercase; letter-spacing: 0.09em; margin-bottom: 0.4rem; }
    .dash-stat-value { font-size: 1.7rem; font-weight: 900; color: var(--black); letter-spacing: -0.04em; line-height: 1; margin-bottom: 0.25rem; }
    .dash-stat-sub { font-size: 0.72rem; color: var(--muted); }
    .dash-grid { display: grid; grid-template-columns: 1.4fr 1fr; gap: 1.2rem; }
    .dash-card { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; }
    .dash-card-header { padding: 1.2rem 1.5rem; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
    .dash-card-header h3 { font-size: 0.9rem; font-weight: 700; }
    .dash-card-header a { font-size: 0.75rem; color: var(--muted); text-decoration: none; min-height: 44px; display: inline-flex; align-items: center; }
    .dash-card-header a:hover { color: var(--black); }
    .active-service { padding: 1.5rem; }
    .active-badge { display: inline-flex; align-items: center; gap: 0.4rem; background: #f0fdf4; border: 1px solid #bbf7d0; color: #16a34a; font-size: 0.7rem; font-weight: 700; padding: 0.28rem 0.75rem; border-radius: 100px; margin-bottom: 1rem; text-transform: uppercase; letter-spacing: 0.07em; }
    .active-dot { width: 5px; height: 5px; border-radius: 50%; background: #16a34a; animation: pulse 2s infinite; }
    .active-service h4 { font-size: 1.05rem; font-weight: 900; color: var(--black); margin-bottom: 0.3rem; }
    .active-service-meta { font-size: 0.8rem; color: var(--muted); margin-bottom: 1.3rem; }
    .active-tech { display: flex; align-items: center; gap: 0.8rem; padding: 1rem 1.2rem; background: var(--bg); border-radius: 10px; border: 1px solid var(--border); margin-bottom: 1.2rem; }
    .tech-avatar { width: 40px; height: 40px; border-radius: 50%; background: var(--black); color: var(--white); display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.85rem; flex-shrink: 0; }
    .tech-info strong { display: block; font-size: 0.85rem; font-weight: 700; color: var(--black); }
    .tech-info span { font-size: 0.75rem; color: var(--muted); }
    .tech-verified { margin-left: auto; background: #0098cf; color: white; font-size: 0.65rem; font-weight: 700; padding: 0.25rem 0.6rem; border-radius: 100px; white-space: nowrap; }
    .progress-steps { display: flex; align-items: center; }
    .pstep { display: flex; flex-direction: column; align-items: center; flex: 1; }
    .pstep-dot { width: 20px; height: 20px; border-radius: 50%; background: var(--bg3); border: 2px solid var(--bg3); display: flex; align-items: center; justify-content: center; font-size: 0.6rem; color: var(--muted); margin-bottom: 0.4rem; transition: all 0.3s; position: relative; z-index: 1; }
    .pstep.done .pstep-dot   { background: var(--black); border-color: var(--black); color: white; }
    .pstep.active .pstep-dot { background: #0098cf; border-color: #0098cf; color: white; }
    .pstep-label { font-size: 0.62rem; color: var(--muted2); text-align: center; }
    .pstep.done .pstep-label  { color: var(--black); font-weight: 700; }
    .pstep.active .pstep-label { color: #0098cf; font-weight: 700; }
    .pstep-line { flex: 1; height: 2px; background: var(--bg3); margin-bottom: 1.1rem; }
    .pstep-line.done { background: var(--black); }
    .service-row { display: flex; align-items: center; padding: 1rem 1.5rem; border-bottom: 1px solid var(--border); gap: 1rem; transition: background 0.15s; min-height: 60px; }
    .service-row:last-child { border-bottom: none; }
    .service-row:hover { background: var(--bg); }
    .service-row-icon { width: 36px; height: 36px; border-radius: 9px; background: var(--bg); border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; font-size: 1rem; flex-shrink: 0; }
    .service-row-info { flex: 1; min-width: 0; }
    .service-row-info strong { display: block; font-size: 0.83rem; font-weight: 700; color: var(--black); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .service-row-info span  { font-size: 0.72rem; color: var(--muted); }
    .service-row-right { text-align: right; flex-shrink: 0; }
    .service-row-price { font-size: 0.85rem; font-weight: 700; color: var(--black); }
    .service-row-status { display: inline-block; font-size: 0.65rem; font-weight: 700; padding: 0.18rem 0.55rem; border-radius: 100px; margin-top: 0.15rem; white-space: nowrap; }
    .status-done     { background: #f0fdf4; color: #16a34a; }
    .status-pending  { background: #fffbeb; color: #d97706; }
    .status-canceled { background: #fef2f2; color: #dc2626; }
    .upcoming-item { display: flex; align-items: center; gap: 1rem; padding: 1rem 1.5rem; border-bottom: 1px solid var(--border); min-height: 60px; transition: background 0.15s; }
    .upcoming-item:last-child { border-bottom: none; }
    .upcoming-item:hover { background: var(--bg); }
    .upcoming-date { width: 40px; text-align: center; flex-shrink: 0; }
    .upcoming-date strong { display: block; font-size: 1.1rem; font-weight: 900; color: var(--black); line-height: 1; }
    .upcoming-date span { font-size: 0.65rem; color: var(--muted2); text-transform: uppercase; }
    .upcoming-info strong { display: block; font-size: 0.83rem; font-weight: 700; color: var(--black); }
    .upcoming-info span   { font-size: 0.72rem; color: var(--muted); }
    .profile-section { padding: 1.5rem; }
    .profile-row { display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem; }
    .profile-avatar-lg { width: 52px; height: 52px; border-radius: 50%; background: var(--black); color: var(--white); display: flex; align-items: center; justify-content: center; font-size: 1.1rem; font-weight: 700; flex-shrink: 0; }
    .profile-name  { font-size: 0.95rem; font-weight: 700; color: var(--black); }
    .profile-email { font-size: 0.78rem; color: var(--muted); }
    .profile-field { display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 0; border-bottom: 1px solid var(--border); font-size: 0.8rem; gap: 1rem; min-height: 48px; }
    .profile-field:last-child { border-bottom: none; }
    .profile-field span:first-child { color: var(--muted); }
    .profile-field span:last-child  { color: var(--black); font-weight: 700; text-align: right; }

    /* ═══════════════════════════════════════════════
       TÚNEL DE CONVERSIÓN — 3 Pasos
    ═══════════════════════════════════════════════ */

    .tnl-overlay {
      display: none;
      position: fixed; inset: 0; z-index: 800;
      background: #f5f5f5;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    .tnl-overlay.tnl-open {
      display: block;
      animation: tnlIn 0.3s cubic-bezier(0.4,0,0.2,1) both;
    }
    @keyframes tnlIn { from{opacity:0;transform:translateY(14px)} to{opacity:1;transform:translateY(0)} }

    .tnl-header {
      position: sticky; top: 0; z-index: 10;
      height: 64px; padding: 0 2rem;
      display: flex; align-items: center; justify-content: space-between;
      background: rgba(245,245,245,0.94);
      backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
    }
    .tnl-logo { font-weight: 900; font-size: 1.25rem; letter-spacing: -0.04em; color: var(--black); }
    .tnl-close {
      display: flex; align-items: center; gap: 0.35rem;
      background: transparent; border: 1px solid var(--border);
      border-radius: var(--rsm); padding: 0.42rem 0.9rem;
      color: var(--muted); font-size: 0.8rem; font-family: var(--font);
      cursor: pointer; min-height: 40px;
      transition: background 0.15s, color 0.15s, border-color 0.15s;
    }
    .tnl-close:hover { background: var(--bg3); color: var(--black); border-color: rgba(0,0,0,0.16); }

    .tnl-progress-bar {
      position: sticky; top: 64px; z-index: 9;
      height: 3px; background: var(--bg3);
    }
    .tnl-progress-fill {
      height: 100%; background: var(--black);
      border-radius: 0 2px 2px 0;
      transition: width 0.45s cubic-bezier(0.4,0,0.2,1);
    }

    .tnl-step-indicator {
      display: flex; justify-content: center; align-items: center;
      gap: 0.6rem; padding: 1.6rem 1rem 0;
    }
    .tnl-dot {
      width: 7px; height: 7px; border-radius: 50%;
      background: var(--bg3);
      transition: background 0.3s, transform 0.3s, width 0.3s;
    }
    .tnl-dot.active  { background: var(--black); transform: scale(1.5); }
    .tnl-dot.done    { background: var(--black); opacity: 0.3; }

    .tnl-body { max-width: 780px; margin: 0 auto; padding: 2.2rem 1.5rem 6rem; }

    .tnl-view { display: none; }
    .tnl-view.tnl-active {
      display: block;
      animation: tnlStepIn 0.32s cubic-bezier(0.4,0,0.2,1) both;
    }
    .tnl-view.tnl-back {
      display: block;
      animation: tnlStepBack 0.32s cubic-bezier(0.4,0,0.2,1) both;
    }
    @keyframes tnlStepIn   { from{opacity:0;transform:translateX(28px)} to{opacity:1;transform:translateX(0)} }
    @keyframes tnlStepBack { from{opacity:0;transform:translateX(-28px)} to{opacity:1;transform:translateX(0)} }

    .tnl-eyebrow { font-size: 0.65rem; font-weight: 700; color: var(--muted2); text-transform: uppercase; letter-spacing: 0.13em; margin-bottom: 0.5rem; }
    .tnl-title   { font-size: clamp(1.55rem, 4vw, 2.1rem); font-weight: 900; letter-spacing: -0.04em; line-height: 1.1; color: var(--black); margin-bottom: 0.45rem; }
    .tnl-sub     { font-size: 0.88rem; color: var(--muted); line-height: 1.65; margin-bottom: 2rem; }

    /* ── PASO 1: Grid de servicios ── */
    .tnl-svc-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0.75rem;
    }
    .tnl-svc-card {
      background: var(--white); border: 2px solid var(--border);
      border-radius: var(--radius); padding: 1.6rem 0.8rem;
      text-align: center; cursor: pointer;
      display: flex; flex-direction: column; align-items: center; gap: 0.55rem;
      transition: border-color 0.18s, transform 0.18s, box-shadow 0.18s;
      -webkit-tap-highlight-color: transparent; user-select: none;
    }
    .tnl-svc-card:hover {
      border-color: rgba(0,0,0,0.2);
      transform: translateY(-3px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.08);
    }
    .tnl-svc-card.tnl-svc-selected {
      border-color: var(--black); background: var(--black);
    }
    .tnl-svc-card.tnl-svc-selected .tnl-svc-icon { filter: grayscale(1) brightness(10); }
    .tnl-svc-card.tnl-svc-selected .tnl-svc-name { color: var(--white); }
    .tnl-svc-icon { font-size: 2.1rem; line-height: 1; }
    .tnl-svc-name { font-size: 0.83rem; font-weight: 700; color: var(--text); }

    /* ── PASO 2: Formulario de contexto ── */
    .tnl-back-btn {
      display: inline-flex; align-items: center; gap: 0.35rem;
      background: transparent; border: none; cursor: pointer;
      font-family: var(--font); font-size: 0.82rem; color: var(--muted);
      padding: 0.4rem 0; margin-bottom: 1.4rem;
      transition: color 0.15s;
    }
    .tnl-back-btn:hover { color: var(--black); }

    .tnl-field { margin-bottom: 1.1rem; }
    .tnl-field label { display: block; font-size: 0.66rem; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: 0.09em; margin-bottom: 0.38rem; }
    .tnl-field select,
    .tnl-field textarea,
    .tnl-field input[type="text"],
    .tnl-field input[type="email"],
    .tnl-field input[type="tel"],
    .tnl-field input[type="date"],
    .tnl-field input[type="time"] {
      width: 100%; background: var(--white); border: 1.5px solid var(--border);
      border-radius: var(--radius); padding: 0.9rem 1.05rem;
      font-size: 1rem; font-family: var(--font); color: var(--text);
      outline: none; -webkit-appearance: none;
      transition: border-color 0.15s, box-shadow 0.15s;
    }
    .tnl-field textarea { min-height: 96px; resize: none; line-height: 1.55; }
    .tnl-field select:focus,
    .tnl-field textarea:focus,
    .tnl-field input:focus { border-color: var(--black); box-shadow: 0 0 0 3px rgba(17,17,17,0.06); }
    .tnl-field input::placeholder,
    .tnl-field textarea::placeholder { color: var(--muted2); }
    .tnl-field input.tnl-error,
    .tnl-field select.tnl-error { border-color: #e53e3e; box-shadow: 0 0 0 3px rgba(229,62,62,0.08); }

    /* Urgencia */
    .tnl-urgency-row { display: grid; grid-template-columns: 1fr 1fr; gap: 0.6rem; margin-bottom: 0.8rem; }
    .tnl-urgency-btn {
      display: flex; align-items: center; justify-content: center; gap: 0.4rem;
      background: var(--white); border: 2px solid var(--border);
      border-radius: var(--radius); padding: 0.9rem 0.6rem;
      font-family: var(--font); font-size: 0.84rem; font-weight: 600;
      color: var(--muted); cursor: pointer; min-height: 52px;
      transition: all 0.18s; -webkit-tap-highlight-color: transparent;
    }
    .tnl-urgency-btn:hover { border-color: rgba(0,0,0,0.2); color: var(--black); }
    .tnl-urgency-btn.tnl-urg-sel { border-color: var(--black); background: var(--black); color: var(--white); }

    /* ── CALENDARIO DE FECHA Y HORA ── */
    .tnl-datetime-wrap {
      display: none;
      background: var(--white);
      border: 1.5px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      margin-bottom: 1.1rem;
      animation: tnlIn 0.22s ease both;
    }
    .tnl-datetime-wrap.visible { display: block; }
    .tnl-datetime-header {
      padding: 0.85rem 1.1rem;
      background: var(--black);
      display: flex; align-items: center; gap: 0.5rem;
    }
    .tnl-datetime-header span { font-size: 0.75rem; font-weight: 700; color: rgba(255,255,255,0.7); text-transform: uppercase; letter-spacing: 0.1em; }
    .tnl-datetime-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0;
    }
    .tnl-datetime-col {
      padding: 1rem 1.1rem;
      border-right: 1px solid var(--border);
    }
    .tnl-datetime-col:last-child { border-right: none; }
    .tnl-datetime-col label {
      display: block;
      font-size: 0.62rem;
      font-weight: 700;
      color: var(--muted2);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: 0.5rem;
    }
    .tnl-datetime-col input[type="date"],
    .tnl-datetime-col input[type="time"] {
      width: 100%;
      border: none;
      background: transparent;
      font-size: 1rem;
      font-family: var(--font);
      color: var(--black);
      font-weight: 700;
      outline: none;
      padding: 0;
      cursor: pointer;
      min-height: 36px;
      -webkit-appearance: none;
    }
    .tnl-datetime-col input[type="date"]::-webkit-calendar-picker-indicator,
    .tnl-datetime-col input[type="time"]::-webkit-calendar-picker-indicator {
      opacity: 0.5;
      cursor: pointer;
    }
    .tnl-fecha-note {
      padding: 0.65rem 1.1rem;
      background: #fffbeb;
      border-top: 1px solid #fef3c7;
      font-size: 0.72rem;
      color: #92400e;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }

    /* Trust box */
    .tnl-trust {
      display: flex; gap: 0.9rem; align-items: flex-start;
      background: var(--white); border: 1px solid var(--border);
      border-radius: var(--radius); padding: 1rem 1.2rem; margin-bottom: 1.5rem;
    }
    .tnl-trust-icon { font-size: 1.25rem; flex-shrink: 0; margin-top: 1px; }
    .tnl-trust p { font-size: 0.8rem; color: var(--muted); line-height: 1.6; }
    .tnl-trust p b { color: var(--black); }

    /* ── PASO 3: Grid resumen + formulario ── */
    .tnl-step3-layout {
      display: grid;
      grid-template-columns: 1fr 1.15fr;
      gap: 1.4rem;
      align-items: start;
    }

    /* Recibo */
    .tnl-receipt {
      background: var(--black); border-radius: var(--radius);
      padding: 1.5rem; position: sticky; top: 84px;
    }
    .tnl-receipt-title { font-size: 0.62rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.13em; color: rgba(255,255,255,0.35); margin-bottom: 1.1rem; }
    .tnl-rrow { display: flex; align-items: flex-start; gap: 0.75rem; padding: 0.7rem 0; border-bottom: 1px solid rgba(255,255,255,0.07); }
    .tnl-rrow:last-of-type { border-bottom: none; margin-bottom: 1rem; }
    .tnl-rrow-ico { width: 30px; height: 30px; border-radius: 7px; background: rgba(255,255,255,0.08); display: flex; align-items: center; justify-content: center; font-size: 0.9rem; flex-shrink: 0; margin-top: 1px; }
    .tnl-rrow-info { flex: 1; min-width: 0; }
    .tnl-rrow-info small { display: block; font-size: 0.6rem; color: rgba(255,255,255,0.35); text-transform: uppercase; letter-spacing: 0.09em; margin-bottom: 0.1rem; }
    .tnl-rrow-info span  { display: block; font-size: 0.83rem; font-weight: 700; color: var(--white); word-break: break-word; }
    .tnl-receipt-badge { display: flex; align-items: center; gap: 0.6rem; background: rgba(255,255,255,0.06); border-radius: 9px; padding: 0.85rem 1rem; }
    .tnl-receipt-badge p { font-size: 0.73rem; color: rgba(255,255,255,0.5); line-height: 1.5; }
    .tnl-receipt-badge p b { color: var(--white); }

    /* Fila de fecha en recibo - oculta por defecto */
    .tnl-rrow-fecha { display: none; }
    .tnl-rrow-fecha.visible { display: flex; }

    /* Formulario paso 3 */
    .tnl-form-card { background: var(--white); border: 1px solid var(--border); border-radius: var(--radius); padding: 1.6rem; }
    .tnl-form-title { font-size: 1.05rem; font-weight: 900; letter-spacing: -0.03em; color: var(--black); margin-bottom: 0.25rem; }
    .tnl-form-sub   { font-size: 0.77rem; color: var(--muted); margin-bottom: 1.4rem; line-height: 1.55; }

    /* Nota de correo */
    .tnl-email-note {
      display: flex; align-items: flex-start; gap: 0.5rem;
      background: #f0f9ff; border: 1px solid #bae6fd;
      border-radius: var(--rsm); padding: 0.65rem 0.85rem;
      margin-top: -0.5rem; margin-bottom: 1rem;
    }
    .tnl-email-note span { font-size: 0.92rem; flex-shrink: 0; }
    .tnl-email-note p { font-size: 0.72rem; color: #0369a1; line-height: 1.5; }
    .tnl-email-note p b { color: #0c4a6e; }

    /* CTA principal */
    .tnl-cta {
      width: 100%; background: var(--black); color: var(--white) !important; border: none;
      border-radius: var(--radius); padding: 1.05rem; font-size: 0.96rem; font-weight: 700;
      font-family: var(--font); cursor: pointer; min-height: 54px;
      display: flex; align-items: center; justify-content: center; gap: 0.5rem;
      transition: opacity 0.18s, transform 0.18s, box-shadow 0.18s;
      margin-top: 0.3rem;
    }
    .tnl-cta:hover:not(:disabled) { opacity: 0.83; transform: translateY(-2px); box-shadow: 0 8px 24px rgba(0,0,0,0.18); }
    .tnl-cta:disabled { opacity: 0.42; cursor: not-allowed; transform: none; box-shadow: none; }
    .tnl-cta-note { font-size: 0.64rem; color: var(--muted2); margin-top: 0.55rem; text-align: center; }

    /* ── ÉXITO con palomita animada ── */
    .tnl-success { display: none; text-align: center; padding: 5rem 2rem 4rem; }
    .tnl-success.tnl-show { display: block; animation: fadeUp 0.5s ease both; }

    /* Círculo negro con SVG animado */
    .tnl-success-ring {
      width: 80px; height: 80px; border-radius: 50%;
      background: var(--black);
      display: flex; align-items: center; justify-content: center;
      margin: 0 auto 1.6rem;
    }

    /* SVG del check interactivo */
    .check-svg {
      width: 44px; height: 44px;
      display: block;
    }
    .check-circle {
      stroke: rgba(255,255,255,0.15);
      stroke-width: 2;
      fill: none;
    }
    .check-mark {
      stroke: #ffffff;
      stroke-width: 3.5;
      stroke-linecap: round;
      stroke-linejoin: round;
      fill: none;
      stroke-dasharray: 36;
      stroke-dashoffset: 36;
      transition: stroke-dashoffset 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }
    /* Cuando el éxito es visible, animar el check */
    .tnl-success.tnl-show .check-mark {
      stroke-dashoffset: 0;
      transition-delay: 0.25s;
    }
    /* Pulso del círculo */
    .tnl-success.tnl-show .tnl-success-ring {
      animation: successPop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) both;
    }
    @keyframes successPop {
      0%   { transform: scale(0.7); opacity: 0; }
      60%  { transform: scale(1.1); }
      100% { transform: scale(1);   opacity: 1; }
    }

    .tnl-success h2 { font-size: 1.7rem; font-weight: 900; letter-spacing: -0.04em; color: var(--black); margin-bottom: 0.55rem; }
    .tnl-success p  { font-size: 0.9rem; color: var(--muted); line-height: 1.7; max-width: 380px; margin: 0 auto 2rem; }


    /* ══ FIREBASE AUTH — Paso 3 ══ */
    .tnl-google-btn {
      width: 100%; background: var(--white); color: #3c3c3c;
      border: 1.5px solid var(--border); border-radius: var(--radius);
      padding: 0.9rem 1rem; font-size: 0.9rem; font-weight: 700;
      font-family: var(--font); cursor: pointer; min-height: 52px;
      display: flex; align-items: center; justify-content: center; gap: 0.65rem;
      transition: border-color 0.18s, box-shadow 0.18s, background 0.18s;
      margin-bottom: 1.2rem;
    }
    .tnl-google-btn:hover { border-color: rgba(0,0,0,0.22); box-shadow: 0 2px 10px rgba(0,0,0,0.07); background: #fafafa; }
    .tnl-google-btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .tnl-google-btn svg { flex-shrink: 0; }

    .tnl-auth-divider {
      display: flex; align-items: center; gap: 0.8rem;
      margin-bottom: 1.2rem; color: var(--muted2); font-size: 0.72rem;
    }
    .tnl-auth-divider::before,
    .tnl-auth-divider::after { content: ''; flex: 1; height: 1px; background: var(--border); }

    .tnl-auth-error {
      display: none; background: #fff0f0; border: 1px solid #fcc;
      border-radius: var(--rsm); padding: 0.65rem 0.9rem;
      font-size: 0.78rem; color: #cc3333; margin-bottom: 0.9rem;
      line-height: 1.5;
    }
    .tnl-auth-error.visible { display: block; animation: fadeUp 0.2s ease both; }

    .tnl-mode-toggle {
      font-size: 0.74rem; color: var(--muted); text-align: center;
      margin-top: 0.6rem; line-height: 1.6;
    }
    .tnl-mode-toggle button {
      background: none; border: none; color: var(--black); font-weight: 700;
      cursor: pointer; font-family: var(--font); font-size: 0.74rem;
      text-decoration: underline; padding: 0; min-height: 0;
    }

    /* Campo contraseña con ojo toggle */
    .tnl-pass-wrap { position: relative; }
    .tnl-pass-wrap input { padding-right: 3rem; }
    .tnl-pass-toggle {
      position: absolute; right: 0.75rem; top: 50%; transform: translateY(-50%);
      background: none; border: none; cursor: pointer; color: var(--muted);
      font-size: 1.1rem; padding: 0.3rem; line-height: 1; display: flex;
      align-items: center; justify-content: center; width: 28px; height: 28px;
    }
    .tnl-pass-toggle:hover { color: var(--black); }

    /* Reset contraseña */
    .tnl-forgot-wrap {
      text-align: right; margin-top: -0.3rem; margin-bottom: 0.2rem;
    }
    .tnl-forgot-btn {
      background: none; border: none; cursor: pointer; font-family: var(--font);
      font-size: 0.72rem; color: var(--muted); text-decoration: underline; padding: 0;
    }
    .tnl-forgot-btn:hover { color: var(--black); }
    .tnl-reset-msg {
      display: none; font-size: 0.74rem; border-radius: var(--rsm);
      padding: 0.6rem 0.85rem; margin-bottom: 0.6rem; line-height: 1.5;
    }
    .tnl-reset-msg.ok  { background: #f0fdf4; color: #16a34a; border: 1px solid #bbf7d0; display: block; }
    .tnl-reset-msg.err { background: #fff0f0; color: #cc3333; border: 1px solid #fcc;    display: block; }

    /* Indicador de sesion activa en paso 3 */
    .tnl-session-banner {
      display: none; align-items: center; gap: 0.7rem;
      background: #f0fdf4; border: 1px solid #bbf7d0;
      border-radius: var(--radius); padding: 0.85rem 1rem; margin-bottom: 1.2rem;
    }
    .tnl-session-banner.visible { display: flex; }
    .tnl-session-avatar {
      width: 32px; height: 32px; border-radius: 50%;
      background: var(--black); color: var(--white);
      display: flex; align-items: center; justify-content: center;
      font-size: 0.75rem; font-weight: 700; flex-shrink: 0;
    }
    .tnl-session-info { flex: 1; }
    .tnl-session-info strong { display: block; font-size: 0.82rem; font-weight: 700; color: #16a34a; }
    .tnl-session-info span   { font-size: 0.72rem; color: var(--muted); }
    .tnl-session-out {
      background: none; border: 1px solid rgba(0,0,0,0.1); border-radius: 6px;
      font-size: 0.7rem; color: var(--muted); cursor: pointer; padding: 0.3rem 0.6rem;
      font-family: var(--font); white-space: nowrap; flex-shrink: 0;
    }
    .tnl-session-out:hover { color: var(--black); border-color: rgba(0,0,0,0.2); }

    /* Auth fields se ocultan si ya hay sesion */
    .tnl-auth-fields { }
    .tnl-auth-fields.hidden { display: none; }

    /* ══ RESPONSIVE ══ */
    @media(max-width:900px){
      .why-strip-inner  { grid-template-columns: 1fr; gap: 3rem; padding: 3rem 2rem; }
      .why-strip-right  { display: none; }
      .services-grid    { grid-template-columns: repeat(4,1fr); }
      .main-content     { grid-template-columns: 1fr; padding: 3rem 2rem; }
      .hero             { grid-template-columns: 1fr; min-height: auto; }
      .hero-right       { height: auto; padding: 0 2rem 3rem; justify-content: center; }
      .carousel-wrap    { max-width: 480px; }
      .dash-stats       { grid-template-columns: repeat(2,1fr); }
      .dash-grid        { grid-template-columns: 1fr; }
      .dash-body        { padding: 2rem; }
      .dash-nav         { padding: 0 1.5rem; }
      .tnl-step3-layout { grid-template-columns: 1fr; }
      .tnl-receipt      { position: static; }
    }

    @media(max-width:600px){
      nav { padding: 0 1.2rem; }
      .nav-center { display: none; }
      .nav-right .btn-ghost { display: none; }
      .nav-right .btn-solid { display: none; }
      .nav-hamburger { display: flex; }
      .hero { grid-template-columns: 1fr; min-height: auto; }
      .hero-left { padding: 2rem 1.2rem 1.5rem; }
      .hero-right { height: auto; padding: 0 1.2rem 2.5rem; }
      .carousel-wrap { max-width: 100%; }
      .carousel-frame { border-radius: 14px; }
      .hero-h1 { font-size: 1.75rem; line-height: 1.1; }
      .hero-sub { font-size: 0.9rem; max-width: 100%; margin-bottom: 1.8rem; }
      .hero-actions { flex-direction: column; gap: 0.5rem; margin-bottom: 2rem; }
      .hero-actions .btn-solid, .hero-actions .btn-ghost { width: 100%; justify-content: center; padding: 0.9rem; font-size: 0.95rem; border-radius: var(--radius); }
      .hero-stats { display: grid; grid-template-columns: 1fr 1fr; width: 100%; border-radius: var(--radius); }
      .hero-stat { padding: 1rem; border-right: 1px solid var(--border); border-bottom: 1px solid var(--border); }
      .hero-stat:nth-child(2) { border-right: none; }
      .hero-stat:nth-child(3) { border-bottom: none; }
      .hero-stat:nth-child(4) { border-right: none; border-bottom: none; }
      .hero-stat strong { font-size: 1.1rem; }
      .hero-stat span   { font-size: 0.6rem; }
      .why-strip-inner  { padding: 2.5rem 1.2rem; gap: 2rem; }
      .why-strip-title  { font-size: 1.4rem; margin-bottom: 1.8rem; }
      .why-strip-right  { display: none; }
      .why-strip-list   { gap: 1.2rem; }
      .services-bar-inner { padding: 1.5rem 1.2rem; }
      .services-bar-top { flex-direction: column; align-items: flex-start; gap: 0.4rem; }
      .services-grid { grid-template-columns: repeat(4,1fr); gap: 0.45rem; }
      .service-pill { padding: 0.8rem 0.3rem; border-radius: 10px; min-height: 70px; gap: 0.3rem; }
      .service-pill-icon  { font-size: 1.35rem; }
      .service-pill-label { font-size: 0.6rem; }
      .main-content { padding: 2rem 1.2rem; gap: 2rem; }
      .block-title  { font-size: 1.2rem; }
      .problem-card { padding: 1.1rem 1.2rem; }
      .how-step { padding: 0.9rem; }
      .block-tab { font-size: 0.79rem; padding: 0.7rem 0.4rem; }
      .why-2col { grid-template-columns: 1fr; }
      .why-card { padding: 1.2rem 1.3rem; }
      .register-form-panel { padding: 1.2rem; }
      .form-row { grid-template-columns: 1fr; gap: 0; }
      footer { flex-direction: column; align-items: flex-start; padding: 1.5rem 1.2rem; }
      .footer-links { display: grid; grid-template-columns: 1fr 1fr; gap: 0; width: 100%; }
      .footer-links a { min-height: 48px; }
      .dash-nav { padding: 0 1.2rem; }
      .dash-user .dash-name { display: none; }
      .dash-body { padding: 1.5rem 1.2rem 2rem; }
      .dash-greeting h1 { font-size: 1.3rem; }
      .dash-stats { grid-template-columns: repeat(2,1fr); gap: 0.7rem; margin-bottom: 1.5rem; }
      .dash-stat-card { padding: 1rem; }
      .dash-stat-value { font-size: 1.4rem; }
      .dash-stat-label { font-size: 0.64rem; }
      .dash-grid { grid-template-columns: 1fr; gap: 1rem; }
      .dash-card-header { padding: 1rem 1.2rem; }
      .active-service { padding: 1.2rem; }
      .active-service h4 { font-size: 0.95rem; }
      .active-tech { padding: 0.85rem 1rem; flex-wrap: wrap; gap: 0.6rem; }
      .tech-verified { margin-left: auto; }
      .pstep-label { font-size: 0.55rem; }
      .pstep-dot { width: 18px; height: 18px; }
      .service-row { padding: 0.9rem 1.2rem; }
      .service-row-info span { font-size: 0.68rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 120px; display: block; }
      .upcoming-item { padding: 0.9rem 1.2rem; }
      .profile-section { padding: 1.2rem; }
      .modal-box { padding: 2rem 1.4rem; margin: 0.8rem; }
      .modal-box h2 { font-size: 1.15rem; }
      /* Túnel móvil */
      .tnl-header  { padding: 0 1.2rem; height: 58px; }
      .tnl-body    { padding: 1.5rem 1.2rem 5rem; }
      .tnl-title   { font-size: 1.45rem; }
      .tnl-svc-grid { grid-template-columns: repeat(3, 1fr); gap: 0.55rem; }
      .tnl-svc-card { padding: 1.2rem 0.4rem; }
      .tnl-svc-icon { font-size: 1.7rem; }
      .tnl-svc-name { font-size: 0.72rem; }
      .tnl-urgency-row { grid-template-columns: 1fr 1fr; }
      .tnl-step3-layout { grid-template-columns: 1fr; }
      .tnl-receipt  { position: static; }
      .tnl-datetime-grid { grid-template-columns: 1fr; }
      .tnl-datetime-col { border-right: none; border-bottom: 1px solid var(--border); }
      .tnl-datetime-col:last-child { border-bottom: none; }
      .tnl-success { padding: 3.5rem 1.2rem 3rem; }
      .tnl-success h2 { font-size: 1.45rem; }
    }

    @media(max-width:380px){
      .hero-h1 { font-size: 1.5rem; }
      .services-grid { gap: 0.3rem; }
      .service-pill-icon  { font-size: 1.2rem; }
      .service-pill-label { font-size: 0.56rem; }
      .dash-stat-value { font-size: 1.25rem; }
      .tnl-svc-grid { grid-template-columns: repeat(3, 1fr); gap: 0.4rem; }
      .tnl-svc-icon { font-size: 1.5rem; }
      .tnl-svc-name { font-size: 0.65rem; }
    }
  </style>
</head>
<body>

<!-- NAV -->
<nav id="main-nav">
  <a href="#" class="nav-logo">thruver</a>
  <ul class="nav-center">
    <li><a href="#servicios">Servicios</a></li>
    <li><a href="#como-funciona">Cómo funciona</a></li>
    <li><a href="#por-que">Por qué Thruver</a></li>
    <li><a href="#registro">Técnicos</a></li>
  </ul>
  <div class="nav-right">
    <button class="btn-ghost" id="btn-open-login">Iniciar sesión</button>
    <a href="#" class="btn-solid tnl-trigger">Solicitar servicio</a>
    <button class="nav-hamburger" id="nav-hamburger" aria-label="Menú">
      <span></span><span></span><span></span>
    </button>
  </div>
</nav>

<!-- MOBILE DRAWER -->
<div class="mobile-menu" id="mobile-menu">
  <a href="#servicios"     id="mm-link-1">🔧 Servicios</a>
  <a href="#como-funciona" id="mm-link-2">⚙️ Cómo funciona</a>
  <a href="#por-que"       id="mm-link-3">🛡️ Por qué Thruver</a>
  <a href="#registro"      id="mm-link-4">👷 Ser técnico</a>
  <div class="mm-divider"></div>
  <div class="mm-cta">
    <button class="btn-ghost" id="btn-open-login-mobile">Iniciar sesión</button>
    <button class="btn-solid tnl-trigger" id="mm-cta">Solicitar servicio →</button>
  </div>
</div>

<!-- ═══════════════════════════════════════════════════════
     TÚNEL DE CONVERSIÓN — FULL SCREEN OVERLAY
═══════════════════════════════════════════════════════ -->
<div class="tnl-overlay" id="tnlOverlay" role="dialog" aria-modal="true" aria-label="Solicitar servicio">

  <header class="tnl-header">
    <span class="tnl-logo">thruver</span>
    <button class="tnl-close" id="tnlClose" aria-label="Cerrar">✕ Cancelar</button>
  </header>

  <div class="tnl-progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="33">
    <div class="tnl-progress-fill" id="tnlFill" style="width:33%"></div>
  </div>

  <div class="tnl-step-indicator" id="tnlDots">
    <div class="tnl-dot active"></div>
    <div class="tnl-dot"></div>
    <div class="tnl-dot"></div>
  </div>

  <div class="tnl-body">

    <!-- ─────────────── PASO 1 ─────────────── -->
    <div class="tnl-view tnl-active" id="tnl-s1">
      <p class="tnl-eyebrow">Paso 1 de 3</p>
      <h2 class="tnl-title">¿En qué te podemos ayudar hoy?</h2>
      <p class="tnl-sub">Selecciona el tipo de servicio y te asignamos un técnico verificado en tu zona.</p>

      <div class="tnl-svc-grid">
        <div class="tnl-svc-card" data-svc="Plomería"      data-ico="🔧"><span class="tnl-svc-icon">🔧</span><span class="tnl-svc-name">Plomería</span></div>
        <div class="tnl-svc-card" data-svc="Electricidad"  data-ico="⚡"><span class="tnl-svc-icon">⚡</span><span class="tnl-svc-name">Electricidad</span></div>
        <div class="tnl-svc-card" data-svc="Limpieza"      data-ico="🧹"><span class="tnl-svc-icon">🧹</span><span class="tnl-svc-name">Limpieza</span></div>
        <div class="tnl-svc-card" data-svc="Pintura"       data-ico="🖌️"><span class="tnl-svc-icon">🖌️</span><span class="tnl-svc-name">Pintura</span></div>
        <div class="tnl-svc-card" data-svc="Aire / Clima"  data-ico="❄️"><span class="tnl-svc-icon">❄️</span><span class="tnl-svc-name">Aire / Clima</span></div>
        <div class="tnl-svc-card" data-svc="Carpintería"   data-ico="🪚"><span class="tnl-svc-icon">🪚</span><span class="tnl-svc-name">Carpintería</span></div>
        <div class="tnl-svc-card" data-svc="Jardinería"    data-ico="🌿"><span class="tnl-svc-icon">🌿</span><span class="tnl-svc-name">Jardinería</span></div>
        <div class="tnl-svc-card" data-svc="Remodelación"  data-ico="🏗️"><span class="tnl-svc-icon">🏗️</span><span class="tnl-svc-name">Remodelación</span></div>
        <div class="tnl-svc-card" data-svc="Otro"          data-ico="💬"><span class="tnl-svc-icon">💬</span><span class="tnl-svc-name">Otro</span></div>
      </div>
    </div>

    <!-- ─────────────── PASO 2 ─────────────── -->
    <div class="tnl-view" id="tnl-s2">
      <button class="tnl-back-btn" id="tnl-back2">← Volver</button>
      <p class="tnl-eyebrow">Paso 2 de 3</p>
      <h2 class="tnl-title">Danos un poco más de contexto</h2>
      <p class="tnl-sub">Nos ayuda a asignarte al técnico correcto mucho más rápido.</p>

      <div class="tnl-field">
        <label>Tipo de espacio</label>
        <select id="tnl-espacio">
          <option value="">Selecciona tu tipo de espacio...</option>
          <option value="Casa / Hogar">🏠  Casa / Hogar</option>
          <option value="Oficina / Empresa">🏢  Oficina / Empresa</option>
          <option value="Local comercial">🏪  Local comercial</option>
          <option value="Industria / Planta">🏭  Industria / Planta</option>
        </select>
      </div>

      <div class="tnl-field">
        <label>¿Qué está fallando exactamente?</label>
        <textarea id="tnl-desc" placeholder="Ej: Se tapó el fregadero y hay una gotera pequeña debajo del lavabo..."></textarea>
      </div>

      <div style="margin-bottom:0.4rem;">
        <p style="font-size:0.66rem;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:0.09em;margin-bottom:0.55rem;">¿Cuándo lo necesitas?</p>
        <div class="tnl-urgency-row">
          <button class="tnl-urgency-btn tnl-urg-sel" id="tnl-u1" data-val="Lo antes posible">⚡ Lo antes posible</button>
          <button class="tnl-urgency-btn"              id="tnl-u2" data-val="Agendar fecha">📅 Agendar fecha</button>
        </div>
      </div>

      <!-- CALENDARIO + HORA (aparece al elegir "Agendar fecha") -->
      <div class="tnl-datetime-wrap" id="tnl-datetime-wrap">
        <div class="tnl-datetime-header">
          <span>📅</span>
          <span>Selecciona tu fecha y hora preferida</span>
        </div>
        <div class="tnl-datetime-grid">
          <div class="tnl-datetime-col">
            <label>Fecha</label>
            <input type="date" id="tnl-fecha" />
          </div>
          <div class="tnl-datetime-col">
            <label>Hora</label>
            <input type="time" id="tnl-hora" value="10:00" />
          </div>
        </div>
        <div class="tnl-fecha-note">
          ⚠️ La fecha es preferencial — Thruver la confirmará por WhatsApp.
        </div>
      </div>

      <div class="tnl-trust">
        <span class="tnl-trust-icon">🛡️</span>
        <p>Thruver te asignará a un técnico <b>verificado con antecedentes revisados</b> y respaldará el trabajo con nuestra <b>Garantía Total</b>. Si no queda bien, regresa sin costo.</p>
      </div>

      <button class="tnl-cta" id="tnl-next2">Continuar →</button>
    </div>

    <!-- ─────────────── PASO 3 ─────────────── -->
    <div class="tnl-view" id="tnl-s3">
      <button class="tnl-back-btn" id="tnl-back3">← Volver</button>
      <p class="tnl-eyebrow">Paso 3 de 3 — Ya casi terminamos</p>

      <div class="tnl-step3-layout">

        <!-- Recibo / Resumen negro -->
        <div class="tnl-receipt">
          <p class="tnl-receipt-title">Tu solicitud</p>

          <div class="tnl-rrow">
            <div class="tnl-rrow-ico" id="r-svc-ico">🔧</div>
            <div class="tnl-rrow-info">
              <small>Servicio</small>
              <span id="r-svc">—</span>
            </div>
          </div>
          <div class="tnl-rrow">
            <div class="tnl-rrow-ico">🏠</div>
            <div class="tnl-rrow-info">
              <small>Espacio</small>
              <span id="r-esp">—</span>
            </div>
          </div>
          <div class="tnl-rrow">
            <div class="tnl-rrow-ico">⏱️</div>
            <div class="tnl-rrow-info">
              <small>Urgencia</small>
              <span id="r-urg">—</span>
            </div>
          </div>
          <!-- FILA DE FECHA Y HORA (visible solo cuando se agenda fecha) -->
          <div class="tnl-rrow tnl-rrow-fecha" id="r-fecha-row">
            <div class="tnl-rrow-ico">📅</div>
            <div class="tnl-rrow-info">
              <small>Fecha programada</small>
              <span id="r-fecha">—</span>
            </div>
          </div>
          <div class="tnl-rrow">
            <div class="tnl-rrow-ico">📝</div>
            <div class="tnl-rrow-info">
              <small>Detalle</small>
              <span id="r-desc" style="font-size:0.77rem;opacity:0.65;font-weight:500;">—</span>
            </div>
          </div>

          <div class="tnl-receipt-badge">
            <span style="font-size:1rem;flex-shrink:0;">✅</span>
            <p><b>Garantía Thruver.</b> Si el trabajo no cumple, el técnico regresa sin costo adicional.</p>
          </div>
        </div>

        <!-- Formulario -->
        <div class="tnl-form-card">
          <h3 class="tnl-form-title">¿A dónde enviamos a tu experto?</h3>
          <p class="tnl-form-sub">Crea tu cuenta o inicia sesión para confirmar y dar seguimiento a tu servicio.</p>

          <div id="tnl-form-fields">

            <!-- Banner sesión activa (visible cuando ya hay sesión) -->
            <div class="tnl-session-banner" id="tnl-session-banner">
              <div class="tnl-session-avatar" id="tnl-session-avatar">?</div>
              <div class="tnl-session-info">
                <strong id="tnl-session-name">—</strong>
                <span id="tnl-session-email">—</span>
              </div>
              <button class="tnl-session-out" id="tnl-session-out">Salir</button>
            </div>

            <!-- Error de autenticación -->
            <div class="tnl-auth-error" id="tnl-auth-error"></div>

            <!-- Bloque de autenticación (se oculta si ya hay sesión) -->
            <div class="tnl-auth-fields" id="tnl-auth-fields">
              <!-- Botón Google -->
              <button class="tnl-google-btn" id="tnl-google-btn" type="button">
                <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
                  <path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844a4.14 4.14 0 0 1-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z"/>
                  <path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332A8.997 8.997 0 0 0 9 18z"/>
                  <path fill="#FBBC05" d="M3.964 10.71A5.41 5.41 0 0 1 3.682 9c0-.593.102-1.17.282-1.71V4.958H.957A8.996 8.996 0 0 0 0 9c0 1.452.348 2.827.957 4.042l3.007-2.332z"/>
                  <path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0A8.997 8.997 0 0 0 .957 4.958L3.964 6.29C4.672 4.163 6.656 3.58 9 3.58z"/>
                </svg>
                Continuar con Google
              </button>

              <div class="tnl-auth-divider">o con tu correo</div>
            </div>

            <!-- Datos de contacto -->
            <div class="tnl-field">
              <label>Nombre completo</label>
              <input type="text" id="tnl-nombre" placeholder="Tu nombre" autocomplete="given-name" />
            </div>

            <div class="tnl-auth-fields" id="tnl-auth-fields-email">
              <div class="tnl-field">
                <label>Correo electrónico</label>
                <input type="email" id="tnl-email" placeholder="tu@correo.com" autocomplete="email" inputmode="email" />
              </div>

              <!-- Contraseña con toggle ver/ocultar -->
              <div class="tnl-field">
                <label id="tnl-pass-label">Contraseña <span id="tnl-pass-hint" style="font-weight:400;text-transform:none;letter-spacing:0;color:var(--muted2);"> — mínimo 6 caracteres</span></label>
                <div class="tnl-pass-wrap">
                  <input type="password" id="tnl-pass" placeholder="••••••••" autocomplete="new-password" />
                  <button class="tnl-pass-toggle" id="tnl-pass-toggle" type="button" aria-label="Ver contraseña">👁️</button>
                </div>
              </div>

              <!-- Mensaje reset contraseña -->
              <div class="tnl-reset-msg" id="tnl-reset-msg"></div>

              <div class="tnl-mode-toggle">
                <span id="tnl-mode-text">¿Ya tienes cuenta?</span>
                <button id="tnl-mode-switch" type="button">Iniciar sesión</button>
              </div>
              <!-- Olvidaste contraseña (solo visible en modo login) -->
              <div class="tnl-forgot-wrap" id="tnl-forgot-wrap" style="display:none;">
                <button class="tnl-forgot-btn" id="tnl-forgot-btn" type="button">¿Olvidaste tu contraseña?</button>
              </div>
            </div>

            <div class="tnl-field">
              <label>WhatsApp</label>
              <input type="tel" id="tnl-tel" placeholder="667 000 0000" autocomplete="tel" inputmode="tel" />
            </div>
            <div class="tnl-field">
              <label>Dirección exacta</label>
              <input type="text" id="tnl-dir" placeholder="Calle, número, colonia..." autocomplete="street-address" />
            </div>

            <button class="tnl-cta" id="tnl-submit">
              <span class="spinner" id="tnl-spinner"></span>
              <span id="tnl-submit-txt">Crear cuenta y confirmar ✓</span>
            </button>
            <!-- Nota de correo — movida debajo del botón -->
            <div class="tnl-email-note" style="margin-top:0.9rem;">
              <span>✉️</span>
              <p>Recibirás tu <b>ticket de soporte</b> desde <b>soporte@thruver.com</b> con todos los detalles de tu servicio.</p>
            </div>
            <p class="tnl-cta-note">Al confirmar podrás ver tu historial de servicios desde tu cuenta.</p>
          </div>
        </div>

      </div>
    </div>

    <!-- ─────────────── ÉXITO ─────────────── -->
    <div class="tnl-success" id="tnl-success">
      <!-- Círculo negro con palomita SVG animada -->
      <div class="tnl-success-ring">
        <svg class="check-svg" viewBox="0 0 52 52" xmlns="http://www.w3.org/2000/svg">
          <circle class="check-circle" cx="26" cy="26" r="22"/>
          <path class="check-mark" d="M14 26 l8 9 l16 -18"/>
        </svg>
      </div>

      <h2>¡Solicitud enviada!</h2>
      <p>Tu solicitud está en camino. Un técnico <strong>verificado por Thruver</strong> se pondrá en contacto por WhatsApp en los próximos minutos.<br/>Revisa también tu correo para el ticket de seguimiento.</p>

      <button class="tnl-cta" id="tnl-ok" style="max-width:260px;margin:0 auto;">Volver al inicio</button>
    </div>

  </div><!-- /tnl-body -->
</div><!-- /tnl-overlay -->

<!-- HERO -->
<section class="hero">
  <div class="hero-grid-pattern"></div>

  <div class="hero-left">
    <div class="hero-badge">
      <span class="badge-dot"></span>
      Culiacán, Sinaloa · Lanzando pronto
    </div>
    <h1 class="hero-h1">Infraestructura de mantenimiento y mejoras para hogares y empresas.</h1>
    <p class="hero-sub">Thruver es la infraestructura confiable para reparar, mantener y mejorar tu hogar o empresa.</p>
    <div class="hero-actions">
      <a href="#" class="btn-solid tnl-trigger">Solicitar servicio →</a>
      <a href="#como-funciona" class="btn-ghost">Cómo funciona</a>
    </div>
    <div class="hero-stats">
      <div class="hero-stat"><strong>100%</strong><span>Verificados</span></div>
      <div class="hero-stat"><strong>Por zona</strong><span>Red curada</span></div>
      <div class="hero-stat"><strong>Garantía</strong><span>O lo resolvemos</span></div>
      <div class="hero-stat"><strong>$0</strong><span>Sin sorpresas</span></div>
    </div>
  </div>

  <div class="hero-right">
    <div class="carousel-wrap">
      <div class="carousel-frame">
        <div class="carousel-slides" id="carouselSlides">
          <div class="carousel-slide active">
            <img src="https://raw.githubusercontent.com/tny-me/thruver.github.io/main/Plomero.jpeg" alt="Plomería" />
          </div>
          <div class="carousel-slide">
            <img src="https://raw.githubusercontent.com/tny-me/thruver.github.io/main/Electrico.jpeg" alt="Electricidad" loading="lazy" />
          </div>
          <div class="carousel-slide">
            <img src="https://raw.githubusercontent.com/tny-me/thruver.github.io/main/Pintor.jpeg" alt="Pintura" loading="lazy" />
          </div>
          <div class="carousel-slide">
            <img src="https://raw.githubusercontent.com/tny-me/thruver.github.io/main/Limpieza.jpeg" alt="Limpieza" loading="lazy" />
          </div>
        </div>
      </div>
      <div class="carousel-dots" id="carouselDots"></div>
    </div>
  </div>
</section>

<!-- WHY STRIP -->
<section class="why-strip">
  <div class="why-strip-inner">
    <div class="why-strip-left">
      <p class="why-strip-eyebrow">¿Por qué Thruver?</p>
      <h2 class="why-strip-title">La forma más confiable de contratar servicios para tu hogar o empresa.</h2>
      <div class="why-strip-list">
        <div class="why-strip-item">
          <div class="why-strip-icon">⭐</div>
          <div class="why-strip-item-text">
            <strong>Experiencia de servicio</strong>
            <p>Una experiencia estandarizada, segura y de alta calidad. Sin importar qué técnico llegue a tu puerta, el nivel de atención siempre es el mismo.</p>
          </div>
        </div>
        <div class="why-strip-item">
          <div class="why-strip-icon">🛡️</div>
          <div class="why-strip-item-text">
            <strong>Red verificada</strong>
            <p>No cualquiera puede ofrecer servicios en Thruver. Cada profesional pasa por entrevistas, pruebas técnicas y revisión estricta de antecedentes.</p>
          </div>
        </div>
        <div class="why-strip-item">
          <div class="why-strip-icon">🔩</div>
          <div class="why-strip-item-text">
            <strong>Experiencia comprobada</strong>
            <p>Nuestros técnicos no solo dicen que saben — <b>lo demuestran</b>. Capacitados, con experiencia real y supervisados por Thruver.</p>
          </div>
        </div>
        <div class="why-strip-item">
          <div class="why-strip-icon">✅</div>
          <div class="why-strip-item-text">
            <strong>Garantía y responsabilidad</strong>
            <p>Si algo no queda bien, Thruver lo resuelve. Sin pretextos, sin excusas y sin desaparecer.</p>
          </div>
        </div>
      </div>
    </div>
    <div class="why-strip-right">
      <div class="why-badge-card">
        <div class="why-badge-icon">
          <svg width="96" height="96" viewBox="0 0 96 96" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M48 6L14 20V44C14 63.8 28.8 82.4 48 88C67.2 82.4 82 63.8 82 44V20L48 6Z" fill="#000000"/>
            <circle cx="48" cy="40" r="13" fill="#ffffff"/>
            <path d="M27 68C27 57.5 36.5 49 48 49C59.5 49 69 57.5 69 68" stroke="#ffffff" stroke-width="5" stroke-linecap="round"/>
          </svg>
        </div>
        <h3>100% calidad asegurada</h3>
        <p>Si no le gusta nuestro servicio, lo solucionaremos.</p>
      </div>
    </div>
  </div>
</section>

<!-- SERVICES BAR -->
<section class="services-bar" id="servicios">
  <div class="services-bar-inner">
    <div class="services-bar-top">
      <h2>¿Qué necesitas hoy?</h2>
      <a href="#" class="link-muted tnl-trigger">Ver todos →</a>
    </div>
    <div class="services-grid">
      <a href="#" class="service-pill tnl-trigger" data-preset="Plomería"><span class="service-pill-icon">🔧</span><span class="service-pill-label">Plomería</span></a>
      <a href="#" class="service-pill tnl-trigger" data-preset="Electricidad"><span class="service-pill-icon">⚡</span><span class="service-pill-label">Electricidad</span></a>
      <a href="#" class="service-pill tnl-trigger" data-preset="Limpieza"><span class="service-pill-icon">🧹</span><span class="service-pill-label">Limpieza</span></a>
      <a href="#" class="service-pill tnl-trigger" data-preset="Pintura"><span class="service-pill-icon">🖌️</span><span class="service-pill-label">Pintura</span></a>
      <a href="#" class="service-pill tnl-trigger" data-preset="Carpintería"><span class="service-pill-icon">🪚</span><span class="service-pill-label">Carpintería</span></a>
      <a href="#" class="service-pill tnl-trigger" data-preset="Jardinería"><span class="service-pill-icon">🌿</span><span class="service-pill-label">Jardinería</span></a>
      <a href="#" class="service-pill tnl-trigger" data-preset="Aire / Clima"><span class="service-pill-icon">❄️</span><span class="service-pill-label">Aire / Clima</span></a>
      <a href="#" class="service-pill tnl-trigger" data-preset="Remodelación"><span class="service-pill-icon">🏗️</span><span class="service-pill-label">Remodelación</span></a>
    </div>
  </div>
</section>

<!-- MAIN CONTENT -->
<div class="main-content">
  <div class="main-left">
    <div>
      <p class="eyebrow">El problema</p>
      <h2 class="block-title">Contratar un técnico en México es una lotería.</h2>
    </div>
    <div class="problem-grid">
      <div class="problem-card">
        <div class="problem-icon">😰</div>
        <div><h3>Sin verificación</h3><p>Cualquiera puede llamarse técnico. No hay forma de saber quién entra a tu hogar antes de que llegue.</p></div>
      </div>
      <div class="problem-card">
        <div class="problem-icon">📵</div>
        <div><h3>Sin tecnología</h3><p>Todo se hace por WhatsApp y recomendaciones. Sin plataforma, sin transparencia, sin trazabilidad.</p></div>
      </div>
      <div class="problem-card">
        <div class="problem-icon">🔁</div>
        <div><h3>Sin garantía</h3><p>Si el trabajo queda mal, no hay a quién reclamar. El cliente pierde tiempo y dinero sin solución.</p></div>
      </div>
    </div>
    <div id="como-funciona">
      <p class="eyebrow" style="margin-top:0.3rem;">Cómo funciona</p>
      <h2 class="block-title">Simple por diseño.</h2>
    </div>
    <div class="how-block">
      <div class="block-tabs">
        <button class="block-tab active" data-tab="how" data-target="how-cliente">Para clientes</button>
        <button class="block-tab" data-tab="how" data-target="how-tecnico">Para técnicos</button>
      </div>
      <div class="tab-panel active" id="how-cliente">
        <div class="how-step"><div class="step-num">01</div><div><h3>Solicita tu servicio</h3><p>Dinos qué necesitas — plomería, electricidad, limpieza. Tipo de espacio y horario preferido.</p></div></div>
        <div class="how-step"><div class="step-num">02</div><div><h3>Asignamos al técnico</h3><p>Thruver asigna al técnico verificado en tu zona. Tú no eliges — nosotros garantizamos el estándar.</p></div></div>
        <div class="how-step"><div class="step-num">03</div><div><h3>El servicio se realiza</h3><p>El técnico llega en el horario acordado, identificado como técnico Thruver. Profesional y puntual.</p></div></div>
        <div class="how-step"><div class="step-num">04</div><div><h3>Pagas y calificas</h3><p>Cobro transparente en la plataforma. Sin efectivo inesperado. Califica el servicio recibido.</p></div></div>
      </div>
      <div class="tab-panel" id="how-tecnico">
        <div class="how-step"><div class="step-num">01</div><div><h3>Regístrate y verifica</h3><p>INE, antecedentes no penales y prueba práctica. Solo los mejores entran a la red Thruver.</p></div></div>
        <div class="how-step"><div class="step-num">02</div><div><h3>Obtén tu zona</h3><p>Cupos limitados por especialidad y zona. Si hay lugar para ti, es tuyo. Sin competencia interna.</p></div></div>
        <div class="how-step"><div class="step-num">03</div><div><h3>Recibe trabajo constante</h3><p>Thruver te asigna servicios. Trabaja bien — nosotros te traemos los clientes.</p></div></div>
        <div class="how-step"><div class="step-num">04</div><div><h3>Cobra por cada servicio</h3><p>Sin suscripción ni cuotas. Thruver retiene una comisión. Si no hay trabajo, no pagas nada.</p></div></div>
      </div>
    </div>
  </div>

  <div class="main-right">
    <div id="por-que">
      <p class="eyebrow">Por qué Thruver</p>
      <h2 class="block-title">No es una app.<br/>Es infraestructura de confianza.</h2>
    </div>
    <div class="why-card why-card-dark">
      <div class="why-card-icon">👤</div>
      <h3>El técnico es invisible. La marca lo es todo.</h3>
      <p>No buscas a una persona — confías en Thruver. Igual que confías en FedEx sin saber quién entrega tu paquete.</p>
    </div>
    <div class="why-card"><h3>Red curada, no abierta</h3><p>Cupos limitados por zona. Los que están adentro trabajan bien y trabajan siempre. Sin competencia entre técnicos.</p></div>
    <div class="why-card"><h3>Verificación real</h3><p>INE, antecedentes no penales y prueba práctica supervisada. Sin los tres no hay cupo. Sin excepciones.</p></div>
    <div class="why-2col">
      <div class="why-card"><h3>Hogares y empresas</h3><p>Un solo proveedor para todos tus espacios sin importar el tamaño.</p></div>
      <div class="why-card"><h3>Garantía real</h3><p>Si el servicio no cumple el estándar, Thruver responde. Sin pretextos.</p></div>
    </div>

    <div id="registro">
      <p class="eyebrow" style="margin-top:0.3rem;">Únete a Thruver</p>
      <h2 class="block-title">Sé de los primeros.</h2>
    </div>
    <div class="register-block">
      <div class="block-tabs">
        <button class="block-tab active" data-tab="reg" data-target="reg-cliente">Solicitar servicio</button>
        <button class="block-tab" data-tab="reg" data-target="reg-tecnico">Ser técnico</button>
      </div>
      <div class="register-form-panel active" id="reg-cliente">
        <div id="rform-cliente">
          <div class="form-row">
            <div class="form-group"><label>Nombre</label><input type="text" id="c-nombre" placeholder="Tu nombre" autocomplete="given-name" /></div>
            <div class="form-group"><label>WhatsApp</label><input type="tel" id="c-telefono" placeholder="667 000 0000" autocomplete="tel" inputmode="tel" /></div>
          </div>
          <div class="form-group"><label>Correo electrónico</label><input type="email" id="c-email" placeholder="tu@correo.com" autocomplete="email" inputmode="email" /></div>
          <div class="form-row">
            <div class="form-group">
              <label>Tipo de espacio</label>
              <select id="c-espacio">
                <option value="">Selecciona...</option>
                <option>Hogar / Casa</option><option>Oficina / Empresa</option>
                <option>Local comercial</option><option>Industria / Planta</option>
              </select>
            </div>
            <div class="form-group">
              <label>Servicio</label>
              <select id="c-servicio">
                <option value="">Selecciona...</option>
                <option>Plomería</option><option>Electricidad</option>
                <option>Limpieza</option><option>Pintura</option>
                <option>Carpintería</option><option>Jardinería</option><option>Otro</option>
              </select>
            </div>
          </div>
          <button class="btn-submit" id="btn-cliente">
            <span class="spinner" id="spinner-cliente"></span>
            <span id="btn-cliente-text">Registrarme como cliente →</span>
          </button>
          <p class="form-note">Te contactamos por WhatsApp para agendar.</p>
        </div>
        <div class="success-msg" id="success-cliente">
          <div class="check">✅</div><h4>¡Registro exitoso!</h4>
          <p>Te contactamos por WhatsApp en las próximas horas.</p>
        </div>
      </div>
      <div class="register-form-panel" id="reg-tecnico">
        <div id="rform-tecnico">
          <div class="form-row">
            <div class="form-group"><label>Nombre</label><input type="text" id="t-nombre" placeholder="Tu nombre" autocomplete="given-name" /></div>
            <div class="form-group"><label>WhatsApp</label><input type="tel" id="t-telefono" placeholder="667 000 0000" autocomplete="tel" inputmode="tel" /></div>
          </div>
          <div class="form-group"><label>Correo electrónico</label><input type="email" id="t-email" placeholder="tu@correo.com" autocomplete="email" inputmode="email" /></div>
          <div class="form-row">
            <div class="form-group">
              <label>Especialidad</label>
              <select id="t-especialidad">
                <option value="">Selecciona...</option>
                <option>Plomero</option><option>Electricista</option><option>Limpieza</option>
                <option>Pintor</option><option>Carpintero</option><option>Jardinero</option><option>Multi-servicio</option>
              </select>
            </div>
            <div class="form-group">
              <label>Experiencia</label>
              <select id="t-experiencia">
                <option value="">Selecciona...</option>
                <option>Menos de 1 año</option><option>1 a 3 años</option>
                <option>3 a 5 años</option><option>Más de 5 años</option>
              </select>
            </div>
          </div>
          <div class="form-group"><label>Colonia donde trabajas</label><input type="text" id="t-zona" placeholder="Ej. Las Quintas, Tres Ríos..." /></div>
          <button class="btn-submit" id="btn-tecnico">
            <span class="spinner" id="spinner-tecnico"></span>
            <span id="btn-tecnico-text">Solicitar mi cupo →</span>
          </button>
          <p class="form-note">Cupos limitados. Te notificamos si hay disponibilidad.</p>
        </div>
        <div class="success-msg" id="success-tecnico">
          <div class="check">✅</div><h4>¡Solicitud recibida!</h4>
          <p>Si hay cupo en tu zona, te contactamos por WhatsApp.</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- FOOTER -->
<footer>
  <div class="footer-logo">thruver</div>
  <div class="footer-links">
    <a href="#servicios">Servicios</a>
    <a href="#como-funciona">Cómo funciona</a>
    <a href="#" class="tnl-trigger">Solicitar servicio</a>
    <a href="#registro">Ser técnico</a>
    <a href="https://wa.me/526670000000" target="_blank">WhatsApp</a>
  </div>
  <p class="footer-copy">© 2025 Thruver · Culiacán, Sinaloa, México</p>
</footer>

<!-- LOGIN MODAL -->
<div class="modal-overlay" id="loginModal">
  <div class="modal-box">
    <button class="modal-close" id="btn-close-login">✕</button>
    <h2>Iniciar sesión</h2>
    <p class="modal-sub">Accede a tu cuenta Thruver</p>
    <div class="modal-error" id="login-error">Por favor ingresa tu correo y contraseña.</div>
    <div class="form-group">
      <label>Correo electrónico</label>
      <input type="email" id="login-email" placeholder="tu@correo.com" inputmode="email" autocomplete="email" />
    </div>
    <div class="form-group">
      <label>Contraseña</label>
      <input type="password" id="login-pass" placeholder="••••••••" autocomplete="current-password" />
    </div>
    <button class="btn-submit" id="btn-do-login" style="margin-top:0.8rem;">
      <span class="spinner" id="spinner-login"></span>
      <span id="btn-login-text">Entrar →</span>
    </button>
  </div>
</div>

<!-- DASHBOARD -->
<div id="dashboard">
  <nav class="dash-nav">
    <a href="javascript:void(0)" class="dash-nav-logo" id="btn-dash-logo">thruver</a>
    <div class="dash-nav-right">
      <div class="dash-user">
        <div class="dash-avatar">AM</div>
        <span class="dash-name">Antonio Moreno</span>
      </div>
      <button class="btn-ghost" id="btn-logout" style="font-size:0.78rem;padding:0.35rem 0.85rem;">Cerrar sesión</button>
    </div>
  </nav>
  <div class="dash-body">
    <div class="dash-greeting">
      <h1>Buen día, Antonio 👋</h1>
      <p>Aquí tienes un resumen de tus servicios con Thruver.</p>
    </div>
    <div class="dash-stats">
      <div class="dash-stat-card"><div class="dash-stat-label">Servicios totales</div><div class="dash-stat-value">7</div><div class="dash-stat-sub">Desde enero 2025</div></div>
      <div class="dash-stat-card"><div class="dash-stat-label">En curso</div><div class="dash-stat-value">1</div><div class="dash-stat-sub">Hoy · 10:00 AM</div></div>
      <div class="dash-stat-card"><div class="dash-stat-label">Próximos</div><div class="dash-stat-value">2</div><div class="dash-stat-sub">Esta semana</div></div>
      <div class="dash-stat-card"><div class="dash-stat-label">Calificación</div><div class="dash-stat-value">4.9</div><div class="dash-stat-sub">⭐ Últimos servicios</div></div>
    </div>
    <div class="dash-grid">
      <div style="display:flex;flex-direction:column;gap:1.2rem;">
        <div class="dash-card">
          <div class="dash-card-header"><h3>Servicio en curso</h3><span style="font-size:0.72rem;color:var(--muted);">Hoy · 10:00 AM</span></div>
          <div class="active-service">
            <div class="active-badge"><span class="active-dot"></span> En progreso</div>
            <h4>Reparación de plomería</h4>
            <p class="active-service-meta">Hogar · Las Quintas, Culiacán</p>
            <div class="active-tech">
              <div class="tech-avatar">MG</div>
              <div class="tech-info"><strong>Miguel González</strong><span>Plomero · 6 años de experiencia</span></div>
              <div class="tech-verified">✓ Verificado</div>
            </div>
            <div class="progress-steps">
              <div class="pstep done"><div class="pstep-dot">✓</div><div class="pstep-label">Asignado</div></div>
              <div class="pstep-line done"></div>
              <div class="pstep done"><div class="pstep-dot">✓</div><div class="pstep-label">En camino</div></div>
              <div class="pstep-line done"></div>
              <div class="pstep active"><div class="pstep-dot">●</div><div class="pstep-label">En trabajo</div></div>
              <div class="pstep-line"></div>
              <div class="pstep"><div class="pstep-dot"></div><div class="pstep-label">Completado</div></div>
            </div>
          </div>
        </div>
        <div class="dash-card">
          <div class="dash-card-header"><h3>Historial de servicios</h3><a href="#">Ver todos →</a></div>
          <div class="service-row"><div class="service-row-icon">⚡</div><div class="service-row-info"><strong>Instalación eléctrica</strong><span>15 Nov 2025 · Oficina Centro</span></div><div class="service-row-right"><div class="service-row-price">$850</div><span class="service-row-status status-done">Completado</span></div></div>
          <div class="service-row"><div class="service-row-icon">🧹</div><div class="service-row-info"><strong>Limpieza profunda</strong><span>02 Nov 2025 · Las Quintas</span></div><div class="service-row-right"><div class="service-row-price">$600</div><span class="service-row-status status-done">Completado</span></div></div>
          <div class="service-row"><div class="service-row-icon">🖌️</div><div class="service-row-info"><strong>Pintura de interiores</strong><span>18 Oct 2025 · Las Quintas</span></div><div class="service-row-right"><div class="service-row-price">$1,200</div><span class="service-row-status status-done">Completado</span></div></div>
          <div class="service-row"><div class="service-row-icon">❄️</div><div class="service-row-info"><strong>Mantenimiento A/C</strong><span>05 Sep 2025 · Oficina Centro</span></div><div class="service-row-right"><div class="service-row-price">$750</div><span class="service-row-status status-pending">Pend. pago</span></div></div>
        </div>
      </div>
      <div style="display:flex;flex-direction:column;gap:1.2rem;">
        <div class="dash-card">
          <div class="dash-card-header"><h3>Próximos servicios</h3><a href="#" class="tnl-trigger">+ Agendar</a></div>
          <div class="upcoming-item"><div class="upcoming-date"><strong>28</strong><span>Feb</span></div><div class="upcoming-info"><strong>Jardinería y poda</strong><span>09:00 AM · Hogar Las Quintas</span></div></div>
          <div class="upcoming-item"><div class="upcoming-date"><strong>03</strong><span>Mar</span></div><div class="upcoming-info"><strong>Revisión eléctrica</strong><span>11:00 AM · Oficina Centro</span></div></div>
        </div>
        <div class="dash-card">
          <div class="dash-card-header"><h3>Mi perfil</h3><a href="#">Editar</a></div>
          <div class="profile-section">
            <div class="profile-row">
              <div class="profile-avatar-lg">AM</div>
              <div><div class="profile-name">Antonio Moreno</div><div class="profile-email"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="53323d273c3d3a3c13303c2121363c7d303c3e">[email&#160;protected]</a></div></div>
            </div>
            <div class="profile-field"><span>Teléfono</span><span>667 123 4567</span></div>
            <div class="profile-field"><span>Tipo de cliente</span><span>Hogar + Empresa</span></div>
            <div class="profile-field"><span>Zona</span><span>Culiacán Norte</span></div>
            <div class="profile-field"><span>Miembro desde</span><span>Enero 2025</span></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
document.addEventListener('DOMContentLoaded', function () {

  var SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyEyoOsNCpYEixE1rksRScf28qSiuYAfDHReo3v8XeFZ725vD3MqxRBs3JmEGZAsMY8/exec';

  /* ─────────────────────────────────────────────
     HELPER: Guardar en Firebase Firestore
     Guarda en la colección indicada.
     Si Firebase no está listo, lo ignora sin romper nada.
  ───────────────────────────────────────────── */
  function saveToFirebase(coleccion, data) {
    return new Promise(function(resolve) {
      if (window.db && window.fbAddDoc && window.fbCollection) {
        var docData = Object.assign({}, data, { creadoEn: new Date().toISOString() });
        window.fbAddDoc(window.fbCollection(window.db, coleccion), docData)
          .then(function(docRef) {
            console.log('[Thruver Firebase] Guardado en "' + coleccion + '" ID: ' + docRef.id);
            resolve(docRef.id);
          })
          .catch(function(err) {
            console.warn('[Thruver Firebase] Error al guardar:', err);
            resolve(null);
          });
      } else {
        console.warn('[Thruver Firebase] SDK no listo, omitiendo.');
        resolve(null);
      }
    });
  }

  /* ═══════════════════════════════════════════
     HAMBURGER / DRAWER
  ═══════════════════════════════════════════ */
  var hamburger  = document.getElementById('nav-hamburger');
  var mobileMenu = document.getElementById('mobile-menu');

  function closeMobileMenu() {
    hamburger.classList.remove('open');
    mobileMenu.classList.remove('open');
    document.body.style.overflow = '';
  }

  hamburger.addEventListener('click', function () {
    var open = mobileMenu.classList.contains('open');
    if (open) { closeMobileMenu(); }
    else { hamburger.classList.add('open'); mobileMenu.classList.add('open'); document.body.style.overflow = 'hidden'; }
  });

  mobileMenu.querySelectorAll('a').forEach(function (a) { a.addEventListener('click', closeMobileMenu); });

  document.getElementById('btn-open-login-mobile').addEventListener('click', function () {
    closeMobileMenu(); openLogin();
  });

  /* ═══════════════════════════════════════════
     TÚNEL DE CONVERSIÓN
  ═══════════════════════════════════════════ */
  var overlay  = document.getElementById('tnlOverlay');
  var fill     = document.getElementById('tnlFill');
  var dots     = document.querySelectorAll('.tnl-dot');
  var success  = document.getElementById('tnl-success');
  var dtWrap   = document.getElementById('tnl-datetime-wrap');

  /* Estado acumulado */
  var T = { servicio:'', ico:'🔧', espacio:'', desc:'', urgencia:'Lo antes posible', fecha:'', hora:'', nombre:'', email:'', tel:'', dir:'' };

  var PROG = { 1:'14%', 2:'58%', 3:'90%' };

  /* ── Abrir túnel ── */
  function openTunnel(presetSvc) {
    resetTunnel();
    overlay.classList.add('tnl-open');
    document.body.style.overflow = 'hidden';
    overlay.scrollTop = 0;
    if (presetSvc) preselectService(presetSvc);
  }

  /* ── Cerrar túnel ── */
  function closeTunnel() {
    overlay.classList.remove('tnl-open');
    document.body.style.overflow = '';
  }

  /* ── Reset completo ── */
  function resetTunnel() {
    T = { servicio:'', ico:'🔧', espacio:'', desc:'', urgencia:'Lo antes posible', fecha:'', hora:'', nombre:'', email:'', tel:'', dir:'' };
    showView(1, true);
    success.classList.remove('tnl-show');
    document.getElementById('tnl-form-fields').style.display = '';
    document.getElementById('tnl-espacio').value = '';
    document.getElementById('tnl-desc').value = '';
    document.getElementById('tnl-nombre').value = '';
    document.getElementById('tnl-email').value = '';
    document.getElementById('tnl-tel').value = '';
    document.getElementById('tnl-dir').value = '';
    document.getElementById('tnl-fecha').value = '';
    document.getElementById('tnl-hora').value = '10:00';
    var passEl2 = document.getElementById('tnl-pass'); if(passEl2) passEl2.value = '';
    var errEl2  = document.getElementById('tnl-auth-error'); if(errEl2) errEl2.classList.remove('visible');
    tnlAuthMode = 'register';
    var submitTxt = document.getElementById('tnl-submit-txt'); if(submitTxt) submitTxt.textContent = 'Crear cuenta y confirmar ✓';
    document.getElementById('tnl-u1').classList.add('tnl-urg-sel');
    document.getElementById('tnl-u2').classList.remove('tnl-urg-sel');
    dtWrap.classList.remove('visible');
    document.getElementById('r-fecha-row').classList.remove('visible');
    document.querySelectorAll('.tnl-svc-card').forEach(function(c){ c.classList.remove('tnl-svc-selected'); });
    var submitBtn = document.getElementById('tnl-submit');
    submitBtn.disabled = false;
    document.getElementById('tnl-spinner').style.display = 'none';
    document.getElementById('tnl-submit-txt').textContent = 'Confirmar solicitud ✓';
    clearErrors();
  }

  /* ── Mostrar vista de paso ── */
  function showView(n, forward) {
    document.querySelectorAll('.tnl-view').forEach(function(v){
      v.classList.remove('tnl-active','tnl-back');
    });
    var v = document.getElementById('tnl-s' + n);
    if (v) {
      v.classList.add(forward === false ? 'tnl-back' : 'tnl-active');
    }
    fill.style.width = PROG[n] || '90%';
    dots.forEach(function(d, i){
      d.classList.remove('active','done');
      if (i + 1 < n)  d.classList.add('done');
      if (i + 1 === n) d.classList.add('active');
    });
    overlay.scrollTop = 0;
  }

  /* ── Formatear fecha legible ── */
  function formatFecha(fecha, hora) {
    if (!fecha) return '';
    var meses = ['Ene','Feb','Mar','Abr','May','Jun','Jul','Ago','Sep','Oct','Nov','Dic'];
    var dias  = ['Dom','Lun','Mar','Mié','Jue','Vie','Sáb'];
    var d = new Date(fecha + 'T12:00:00');
    var str = dias[d.getDay()] + ' ' + d.getDate() + ' ' + meses[d.getMonth()] + ' ' + d.getFullYear();
    if (hora) str += ' · ' + hora;
    return str;
  }

  /* ── Pre-seleccionar servicio ── */
  function preselectService(svc) {
    var card = document.querySelector('.tnl-svc-card[data-svc="' + svc + '"]');
    if (card) {
      card.classList.add('tnl-svc-selected');
      T.servicio = svc;
      T.ico = card.getAttribute('data-ico') || '🔧';
      setTimeout(function(){ showView(2, true); }, 200);
    }
  }

  /* ── Actualizar recibo ── */
  function updateReceipt() {
    document.getElementById('r-svc-ico').textContent = T.ico;
    document.getElementById('r-svc').textContent  = T.servicio  || '—';
    document.getElementById('r-esp').textContent  = T.espacio   || '—';
    document.getElementById('r-urg').textContent  = T.urgencia  || '—';
    var d = T.desc || '—';
    document.getElementById('r-desc').textContent = d.length > 70 ? d.slice(0,70) + '…' : d;

    /* Fecha programada: visible solo si se agendó */
    var fechaRow = document.getElementById('r-fecha-row');
    if (T.urgencia === 'Agendar fecha' && T.fecha) {
      document.getElementById('r-fecha').textContent = formatFecha(T.fecha, T.hora);
      fechaRow.classList.add('visible');
    } else {
      fechaRow.classList.remove('visible');
    }
  }

  /* ── Helpers de validación ── */
  function markError(id) {
    var el = document.getElementById(id);
    if (el) el.classList.add('tnl-error');
  }
  function clearErrors() {
    document.querySelectorAll('.tnl-error').forEach(function(el){ el.classList.remove('tnl-error'); });
  }

  /* ── Validar email ── */
  function isValidEmail(e) {
    return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);
  }

  /* ─────── Triggers de apertura ─────── */
  document.querySelectorAll('.tnl-trigger').forEach(function (el) {
    el.addEventListener('click', function (e) {
      e.preventDefault();
      closeMobileMenu();
      var preset = el.getAttribute('data-preset') || null;
      openTunnel(preset);
    });
  });

  /* ─────── Cerrar ─────── */
  document.getElementById('tnlClose').addEventListener('click', closeTunnel);
  document.addEventListener('keydown', function(e){ if (e.key === 'Escape' && overlay.classList.contains('tnl-open')) closeTunnel(); });

  /* ─────── PASO 1: clic en tarjeta de servicio ─────── */
  document.querySelectorAll('.tnl-svc-card').forEach(function (card) {
    card.addEventListener('click', function () {
      document.querySelectorAll('.tnl-svc-card').forEach(function(c){ c.classList.remove('tnl-svc-selected'); });
      card.classList.add('tnl-svc-selected');
      T.servicio = card.getAttribute('data-svc');
      T.ico      = card.getAttribute('data-ico') || '🔧';
      setTimeout(function(){ showView(2, true); }, 240);
    });
  });

  /* ─────── PASO 2: urgencia toggle con calendario ─────── */
  document.getElementById('tnl-u1').addEventListener('click', function () {
    T.urgencia = 'Lo antes posible';
    this.classList.add('tnl-urg-sel');
    document.getElementById('tnl-u2').classList.remove('tnl-urg-sel');
    dtWrap.classList.remove('visible');
  });
  document.getElementById('tnl-u2').addEventListener('click', function () {
    T.urgencia = 'Agendar fecha';
    this.classList.add('tnl-urg-sel');
    document.getElementById('tnl-u1').classList.remove('tnl-urg-sel');
    /* Mostrar calendario y establecer mínimo de hoy */
    var today = new Date();
    var yyyy  = today.getFullYear();
    var mm    = String(today.getMonth() + 1).padStart(2, '0');
    var dd    = String(today.getDate()).padStart(2, '0');
    document.getElementById('tnl-fecha').min = yyyy + '-' + mm + '-' + dd;
    dtWrap.classList.add('visible');
    /* Scroll suave al calendario en móvil */
    setTimeout(function(){
      dtWrap.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }, 100);
  });

  /* ─────── PASO 2: continuar ─────── */
  document.getElementById('tnl-next2').addEventListener('click', function () {
    clearErrors();
    var esp = document.getElementById('tnl-espacio').value;
    if (!esp) { markError('tnl-espacio'); document.getElementById('tnl-espacio').focus(); return; }

    /* Validar fecha si eligió agendar */
    if (T.urgencia === 'Agendar fecha') {
      var fechaVal = document.getElementById('tnl-fecha').value;
      if (!fechaVal) {
        document.getElementById('tnl-fecha').classList.add('tnl-error');
        dtWrap.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        return;
      }
      T.fecha = fechaVal;
      T.hora  = document.getElementById('tnl-hora').value || '10:00';
    } else {
      T.fecha = '';
      T.hora  = '';
    }

    T.espacio = esp;
    T.desc    = document.getElementById('tnl-desc').value.trim();
    updateReceipt();
    showView(3, true);
  });

  /* ─────── Botones de volver ─────── */
  document.getElementById('tnl-back2').addEventListener('click', function(){ showView(1, false); });
  document.getElementById('tnl-back3').addEventListener('click', function(){ showView(2, false); });

  /* ------- AUTH STATE ------- */
  var tnlAuthMode = 'register';

  window.onUserLoggedIn = function(user) {
    var banner = document.getElementById('tnl-session-banner');
    if (!banner) return;
    var initials = (user.displayName || user.email || '?').charAt(0).toUpperCase();
    document.getElementById('tnl-session-avatar').textContent = initials;
    document.getElementById('tnl-session-name').textContent   = user.displayName || 'Usuario';
    document.getElementById('tnl-session-email').textContent  = user.email || '';
    banner.classList.add('visible');
    document.querySelectorAll('.tnl-auth-fields').forEach(function(el){ el.classList.add('hidden'); });
    var nEl = document.getElementById('tnl-nombre'); if (nEl && user.displayName) nEl.value = user.displayName;
    var eEl = document.getElementById('tnl-email');  if (eEl && user.email) eEl.value = user.email;
    document.getElementById('tnl-submit-txt').textContent = 'Confirmar solicitud ✓';
    actualizarNavConUsuario(user);
  };

  window.onUserLoggedOut = function() {
    var banner = document.getElementById('tnl-session-banner');
    if (banner) banner.classList.remove('visible');
    document.querySelectorAll('.tnl-auth-fields').forEach(function(el){ el.classList.remove('hidden'); });
  };

  document.getElementById('tnl-session-out').addEventListener('click', function() {
    if (window.fbSignOut && window.auth) window.fbSignOut(window.auth).catch(function(){});
  });

  document.getElementById('tnl-pass-toggle').addEventListener('click', function() {
    var inp = document.getElementById('tnl-pass');
    if (inp.type === 'password') { inp.type = 'text'; this.innerHTML = '🕶️'; }
    else { inp.type = 'password'; this.innerHTML = '👁️'; }
  });

  document.getElementById('tnl-mode-switch').addEventListener('click', function() {
    var forgotWrap = document.getElementById('tnl-forgot-wrap');
    var resetMsg   = document.getElementById('tnl-reset-msg');
    if (tnlAuthMode === 'register') {
      tnlAuthMode = 'login';
      document.getElementById('tnl-mode-text').textContent  = '¿No tienes cuenta?';
      this.textContent = 'Crear cuenta';
      document.getElementById('tnl-pass-hint').textContent  = '';
      document.getElementById('tnl-submit-txt').textContent = 'Iniciar sesión y confirmar ✓';
      document.getElementById('tnl-pass').setAttribute('autocomplete','current-password');
      if (forgotWrap) forgotWrap.style.display = 'block';
    } else {
      tnlAuthMode = 'register';
      document.getElementById('tnl-mode-text').textContent  = '¿Ya tienes cuenta?';
      this.textContent = 'Iniciar sesión';
      document.getElementById('tnl-pass-hint').textContent  = ' — mínimo 6 caracteres';
      document.getElementById('tnl-submit-txt').textContent = 'Crear cuenta y confirmar ✓';
      document.getElementById('tnl-pass').setAttribute('autocomplete','new-password');
      if (forgotWrap) forgotWrap.style.display = 'none';
      if (resetMsg) { resetMsg.className = 'tnl-reset-msg'; resetMsg.textContent = ''; }
    }
  });

  /* ------- Olvidaste contrasena ------- */
  document.getElementById('tnl-forgot-btn').addEventListener('click', function() {
    var emailEl  = document.getElementById('tnl-email');
    var resetMsg = document.getElementById('tnl-reset-msg');
    var email    = emailEl ? emailEl.value.trim() : '';
    resetMsg.className = 'tnl-reset-msg'; resetMsg.textContent = '';
    if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
      resetMsg.textContent = 'Ingresa tu correo arriba primero.';
      resetMsg.className = 'tnl-reset-msg err';
      if (emailEl) emailEl.focus();
      return;
    }
    var btn = this; btn.disabled = true; btn.textContent = 'Enviando...';
    if (window.auth && window.fbSendPasswordReset) {
      window.fbSendPasswordReset(window.auth, email)
        .then(function() {
          resetMsg.textContent = '✅ Correo enviado a ' + email + '. Revisa tu bandeja (y spam).';
          resetMsg.className = 'tnl-reset-msg ok';
        })
        .catch(function(err) {
          var msg = err.code === 'auth/user-not-found'
            ? 'No encontramos una cuenta con ese correo.'
            : 'Error al enviar: ' + err.message;
          resetMsg.textContent = msg;
          resetMsg.className = 'tnl-reset-msg err';
        })
        .finally(function() { btn.disabled = false; btn.textContent = '¿Olvidaste tu contraseña?'; });
    } else {
      resetMsg.textContent = 'Firebase no está listo. Recarga la página.';
      resetMsg.className = 'tnl-reset-msg err';
      btn.disabled = false; btn.textContent = '¿Olvidaste tu contraseña?';
    }
  });

  document.getElementById('tnl-google-btn').addEventListener('click', function() {
    var errEl = document.getElementById('tnl-auth-error');
    errEl.classList.remove('visible');
    if (!window.fbSignInWithPopup || !window.auth || !window.fbGoogleProvider) {
      errEl.textContent = 'Firebase no est\u00E1 listo. Recarga la p\u00E1gina.';
      errEl.classList.add('visible'); return;
    }
    var btn = this; btn.disabled = true; btn.textContent = 'Conectando con Google...';
    window.fbSignInWithPopup(window.auth, window.fbGoogleProvider)
      .then(function(r){ console.log('[Thruver] Google OK:', r.user.uid); })
      .catch(function(err){ errEl.textContent = 'Error con Google: ' + err.message; errEl.classList.add('visible'); })
      .finally(function(){
        btn.disabled = false;
        btn.innerHTML = '<svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg"><path fill="#4285F4" d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844a4.14 4.14 0 0 1-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z"/><path fill="#34A853" d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332A8.997 8.997 0 0 0 9 18z"/><path fill="#FBBC05" d="M3.964 10.71A5.41 5.41 0 0 1 3.682 9c0-.593.102-1.17.282-1.71V4.958H.957A8.996 8.996 0 0 0 0 9c0 1.452.348 2.827.957 4.042l3.007-2.332z"/><path fill="#EA4335" d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0A8.997 8.997 0 0 0 .957 4.958L3.964 6.29C4.672 4.163 6.656 3.58 9 3.58z"/></svg> Continuar con Google';
      });
  });

  /* ------- PASO 3: envio final con Firebase Auth ------- */
  document.getElementById('tnl-submit').addEventListener('click', function () {
    clearErrors();
    var errEl = document.getElementById('tnl-auth-error');
    errEl.classList.remove('visible');
    var nombre = document.getElementById('tnl-nombre').value.trim();
    var emailEl = document.getElementById('tnl-email');
    var email   = emailEl ? emailEl.value.trim() : '';
    var tel     = document.getElementById('tnl-tel').value.trim();
    var dir     = document.getElementById('tnl-dir').value.trim();
    var passEl  = document.getElementById('tnl-pass');
    var pass    = passEl ? passEl.value : '';
    var valid   = true;
    var haySession = window.currentUser != null;
    if (!nombre) { markError('tnl-nombre'); valid = false; }
    if (!tel)    { markError('tnl-tel');    valid = false; }
    if (!dir)    { markError('tnl-dir');    valid = false; }
    if (!haySession) {
      if (!isValidEmail(email)) { markError('tnl-email'); valid = false; }
      if (!pass || pass.length < 6) { if(passEl) passEl.classList.add('tnl-error'); valid = false; }
    }
    if (!valid) { var fe = document.querySelector('.tnl-error'); if(fe) fe.scrollIntoView({behavior:'smooth',block:'center'}); return; }
    T.nombre = nombre;
    T.email  = email || (window.currentUser ? window.currentUser.email : '');
    T.tel = tel; T.dir = dir;
    var btn = document.getElementById('tnl-submit');
    btn.disabled = true;
    document.getElementById('tnl-spinner').style.display = 'block';
    document.getElementById('tnl-submit-txt').textContent = 'Procesando...';

    function enviarSolicitud(uid, userEmail, userName) {
      var payload = {
        tipo:'CLIENTE', uid:uid, servicio:T.servicio, espacio:T.espacio,
        descripcion:T.desc, urgencia:T.urgencia,
        fecha_programada: T.urgencia==='Agendar fecha' ? formatFecha(T.fecha,T.hora) : '',
        nombre:userName||T.nombre, email:userEmail||T.email,
        telefono:T.tel, direccion:T.dir, estado:'nueva',
        timestamp:new Date().toISOString()
      };
      fetch(SCRIPT_URL,{method:'POST',mode:'no-cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)}).catch(function(){});
      saveToFirebase('solicitudes', payload).finally(function(){
        var h2 = document.querySelector('#tnl-success h2');
        if (h2) h2.textContent = '\u00A1Listo, ' + (userName||T.nombre).split(' ')[0] + '!';
        document.querySelectorAll('.tnl-view').forEach(function(v){ v.classList.remove('tnl-active','tnl-back'); });
        fill.style.width = '100%';
        dots.forEach(function(d){ d.classList.add('done'); d.classList.remove('active'); });
        success.classList.add('tnl-show');
        overlay.scrollTop = 0;
      });
    }

    if (haySession) { var u = window.currentUser; enviarSolicitud(u.uid, u.email, u.displayName||T.nombre); return; }
    if (!window.fbCreateUser || !window.auth) {
      errEl.textContent = 'Firebase no est\u00E1 listo. Recarga la p\u00E1gina.';
      errEl.classList.add('visible');
      btn.disabled=false; document.getElementById('tnl-spinner').style.display='none';
      document.getElementById('tnl-submit-txt').textContent='Confirmar solicitud \u2713'; return;
    }
    var authPromise = tnlAuthMode==='register'
      ? window.fbCreateUser(window.auth, email, pass)
      : window.fbSignIn(window.auth, email, pass);
    authPromise
      .then(function(result) {
        window.currentUser = result.user;
        actualizarNavConUsuario(result.user);
        enviarSolicitud(result.user.uid, result.user.email, T.nombre);
      })
      .catch(function(err) {
        var msgs = {
          'auth/email-already-in-use':'Este correo ya tiene cuenta. Usa \"Iniciar sesi\u00F3n\".',
          'auth/wrong-password':'Contrase\u00F1a incorrecta.',
          'auth/invalid-credential':'Correo o contrase\u00F1a incorrectos.',
          'auth/user-not-found':'No encontramos esta cuenta.',
          'auth/weak-password':'La contrase\u00F1a debe tener al menos 6 caracteres.'
        };
        errEl.textContent = msgs[err.code] || ('Error: ' + err.message);
        errEl.classList.add('visible');
        errEl.scrollIntoView({behavior:'smooth',block:'center'});
        btn.disabled=false; document.getElementById('tnl-spinner').style.display='none';
        document.getElementById('tnl-submit-txt').textContent = tnlAuthMode==='register' ? 'Crear cuenta y confirmar \u2713' : 'Iniciar sesi\u00F3n y confirmar \u2713';
      });
  });

  /* ------- Exito: ir al dashboard ------- */
  document.getElementById('tnl-ok').addEventListener('click', function() {
    closeTunnel();
    if (window.currentUser) cargarHistorialYMostrarDashboard(window.currentUser);
  });

  /* ------- Actualizar nav con usuario ------- */
  function actualizarNavConUsuario(user) {
    var dn = user.displayName || user.email || 'Usuario';
    var av = document.querySelector('.dash-avatar'); if(av) av.textContent = dn.charAt(0).toUpperCase();
    var nm = document.querySelector('.dash-name');   if(nm) nm.textContent = dn.split(' ')[0];
    var gr = document.querySelector('.dash-greeting h1'); if(gr) gr.textContent = 'Buen d\u00EDa, ' + dn.split(' ')[0] + ' \uD83D\uDC4B';
    var pn = document.querySelector('.profile-name');  if(pn) pn.textContent = dn;
    var pe = document.querySelector('.profile-email'); if(pe) pe.textContent = user.email || '';
  }

  /* ------- Cargar historial y mostrar dashboard ------- */
  function cargarHistorialYMostrarDashboard(user) {
    actualizarNavConUsuario(user);
    showDashboard();
    if (!window.fbGetDocs||!window.fbQuery||!window.fbWhere||!window.db) return;
    window.fbGetDocs(window.fbQuery(window.fbCollection(window.db,'solicitudes'),window.fbWhere('uid','==',user.uid)))
      .then(function(snap) {
        var svcs=[];
        snap.forEach(function(d){ svcs.push(d.data()); });
        svcs.sort(function(a,b){ return b.timestamp>a.timestamp?1:-1; });
        var tot = document.querySelector('.dash-stat-value'); if(tot) tot.textContent=svcs.length;
        renderizarHistorial(svcs);
      }).catch(function(e){ console.warn('[Thruver] Historial error:',e); });
  }

  /* ------- Renderizar historial ------- */
  function renderizarHistorial(svcs) {
    var histEl=null;
    document.querySelectorAll('.dash-card-header h3').forEach(function(h){ if(h.textContent.trim()==='Historial de servicios') histEl=h.closest('.dash-card'); });
    if(!histEl||svcs.length===0) return;
    histEl.querySelectorAll('.service-row').forEach(function(r){ r.remove(); });
    var ic={'Plomer\u00EDa':'\uD83D\uDD27','Electricidad':'\u26A1','Limpieza':'\uD83E\uDDF9','Pintura':'\uD83D\uDD8C\uFE0F','Carpinter\u00EDa':'\uD83E\uDEA8','Jardiner\u00EDa':'\uD83C\uDF3F','Aire / Clima':'\u2744\uFE0F','Remodelaci\u00F3n':'\uD83C\uDFD7\uFE0F','Otro':'\uD83D\uDCAC'};
    svcs.slice(0,8).forEach(function(s){
      var ico=ic[s.servicio]||'\uD83D\uDD27';
      var fecha=s.timestamp?new Date(s.timestamp).toLocaleDateString('es-MX',{day:'2-digit',month:'short',year:'numeric'}):'\u2014';
      var row=document.createElement('div'); row.className='service-row';
      row.innerHTML='<div class="service-row-icon">'+ico+'</div><div class="service-row-info"><strong>'+(s.servicio||'\u2014')+'</strong><span>'+fecha+' \u00B7 '+(s.espacio||'\u2014')+'</span></div><div class="service-row-right"><span class="service-row-status status-done">Enviada</span></div>';
      histEl.appendChild(row);
    });
  }


  /* ═══════════════════════════════════════════
     LOGIN MODAL — con Firebase Auth
  ═══════════════════════════════════════════ */
  var loginModal   = document.getElementById('loginModal');
  var loginEmail   = document.getElementById('login-email');
  var loginPass    = document.getElementById('login-pass');
  var loginError   = document.getElementById('login-error');
  var loginBtn     = document.getElementById('btn-do-login');
  var loginText    = document.getElementById('btn-login-text');
  var loginSpinner = document.getElementById('spinner-login');

  function openLogin() { loginModal.classList.add('open'); setTimeout(function(){ loginEmail.focus(); }, 100); }
  function closeLogin() {
    loginModal.classList.remove('open');
    loginError.style.display = 'none';
    loginEmail.value = ''; loginPass.value = '';
    loginBtn.disabled = false;
    loginSpinner.style.display = 'none';
    loginText.textContent = 'Entrar →';
  }
  function doLogin() {
    if (!loginEmail.value.trim() || !loginPass.value.trim()) { loginError.style.display = 'block'; loginError.textContent = 'Por favor ingresa tu correo y contraseña.'; return; }
    loginError.style.display = 'none';
    loginBtn.disabled = true; loginSpinner.style.display = 'block'; loginText.textContent = 'Verificando...';
    if (window.fbSignIn && window.auth) {
      window.fbSignIn(window.auth, loginEmail.value.trim(), loginPass.value.trim())
        .then(function(result) {
          window.currentUser = result.user;
          closeLogin();
          cargarHistorialYMostrarDashboard(result.user);
        })
        .catch(function(err) {
          loginError.textContent = (err.code === 'auth/invalid-credential' || err.code === 'auth/wrong-password')
            ? 'Correo o contraseña incorrectos.'
            : err.code === 'auth/user-not-found' ? 'No encontramos esta cuenta.'
            : 'Error: ' + err.message;
          loginError.style.display = 'block';
          loginBtn.disabled = false; loginSpinner.style.display = 'none'; loginText.textContent = 'Entrar →';
        });
    } else {
      setTimeout(function(){ closeLogin(); showDashboard(); }, 900);
    }
  }
  document.getElementById('btn-open-login').addEventListener('click', openLogin);
  document.getElementById('btn-close-login').addEventListener('click', closeLogin);
  loginModal.addEventListener('click', function(e){ if (e.target === loginModal) closeLogin(); });
  loginBtn.addEventListener('click', doLogin);
  loginPass.addEventListener('keydown', function(e){ if (e.key === 'Enter') doLogin(); });

  /* ═══════════════════════════════════════════
     DASHBOARD
  ═══════════════════════════════════════════ */
  var dashboard = document.getElementById('dashboard');
  var mainNav   = document.getElementById('main-nav');

  function showDashboard() {
    dashboard.style.cssText = 'display:block;position:fixed;top:0;left:0;right:0;bottom:0;z-index:500;overflow-y:auto;background:#f3f3f3;padding-top:60px;';
    mainNav.style.display = 'none';
    document.body.style.overflow = 'hidden';
    dashboard.scrollTop = 0;
  }
  function closeDashboard() { dashboard.style.display='none'; mainNav.style.display='flex'; document.body.style.overflow=''; }

  document.getElementById('btn-dash-logo').addEventListener('click', closeDashboard);
  document.getElementById('btn-logout').addEventListener('click', function() {
    if (window.fbSignOut && window.auth) {
      window.fbSignOut(window.auth).then(function(){ window.currentUser = null; closeDashboard(); }).catch(closeDashboard);
    } else { closeDashboard(); }
  });

  /* ═══════════════════════════════════════════
     CAROUSEL
  ═══════════════════════════════════════════ */
  var slides = document.querySelectorAll('.carousel-slide');
  var dotsEl = document.getElementById('carouselDots');
  var cur = 0, timer;

  slides.forEach(function(_, i) {
    var d = document.createElement('div');
    d.className = 'carousel-dot' + (i === 0 ? ' active' : '');
    d.addEventListener('click', function(){ goTo(i); });
    dotsEl.appendChild(d);
  });

  function goTo(n) {
    slides[cur].classList.remove('active');
    dotsEl.children[cur].classList.remove('active');
    cur = (n + slides.length) % slides.length;
    slides[cur].classList.add('active');
    dotsEl.children[cur].classList.add('active');
    document.getElementById('carouselSlides').style.transform = 'translateX(-' + (cur * 100) + '%)';
    clearInterval(timer);
    timer = setInterval(function(){ goTo(cur + 1); }, 4200);
  }

  var tsX = 0;
  var cf  = document.querySelector('.carousel-frame');
  cf.addEventListener('touchstart', function(e){ tsX = e.touches[0].clientX; }, { passive:true });
  cf.addEventListener('touchend',   function(e){ var d = tsX - e.changedTouches[0].clientX; if (Math.abs(d) > 40) goTo(d > 0 ? cur+1 : cur-1); }, { passive:true });
  timer = setInterval(function(){ goTo(cur + 1); }, 4200);

  /* ═══════════════════════════════════════════
     TABS
  ═══════════════════════════════════════════ */
  document.querySelectorAll('.block-tab[data-tab]').forEach(function(btn){
    btn.addEventListener('click', function(){
      var target = btn.getAttribute('data-target');
      var parent = btn.closest('.how-block,.register-block');
      parent.querySelectorAll('.block-tab').forEach(function(b){ b.classList.remove('active'); });
      parent.querySelectorAll('.tab-panel,.register-form-panel').forEach(function(p){ p.classList.remove('active'); });
      btn.classList.add('active');
      var panel = document.getElementById(target);
      if (panel) panel.classList.add('active');
    });
  });

  /* ═══════════════════════════════════════════
     FORM SIMPLE (registro de la pagina)
  ═══════════════════════════════════════════ */
  document.getElementById('btn-cliente').addEventListener('click', function(){ submitSimpleForm('cliente'); });
  document.getElementById('btn-tecnico').addEventListener('click', function(){ submitSimpleForm('tecnico'); });

  function submitSimpleForm(tipo) {
    var data = {};
    if (tipo === 'cliente') {
      var nombre=document.getElementById('c-nombre').value.trim(), tel=document.getElementById('c-telefono').value.trim(),
          email=document.getElementById('c-email').value.trim(), esp=document.getElementById('c-espacio').value, svc=document.getElementById('c-servicio').value;
      if (!nombre||!tel||!esp||!svc){ alert('Por favor completa todos los campos.'); return; }
      data = { tipo:'CLIENTE', nombre:nombre, telefono:tel, email:email, espacio:esp, servicio:svc };
    } else {
      var tn=document.getElementById('t-nombre').value.trim(), tt=document.getElementById('t-telefono').value.trim(),
          te=document.getElementById('t-email').value.trim(), tesp=document.getElementById('t-especialidad').value,
          tz=document.getElementById('t-zona').value.trim(), tx=document.getElementById('t-experiencia').value;
      if (!tn||!tt||!tesp||!tz){ alert('Por favor completa todos los campos.'); return; }
      data = { tipo:'TECNICO', nombre:tn, telefono:tt, email:te, especialidad:tesp, zona:tz, experiencia:tx };
    }
    var btn=document.getElementById('btn-'+tipo), sp=document.getElementById('spinner-'+tipo), bt=document.getElementById('btn-'+tipo+'-text');
    btn.disabled=true; sp.style.display='block'; bt.textContent='Enviando...';
    var coleccion = (tipo === 'tecnico') ? 'tecnicos' : 'clientes';
    fetch(SCRIPT_URL,{method:'POST',mode:'no-cors',headers:{'Content-Type':'application/json'},body:JSON.stringify(data)}).catch(function(){});
    saveToFirebase(coleccion, data).finally(function(){
      document.getElementById('rform-'+tipo).style.display='none';
      document.getElementById('success-'+tipo).style.display='block';
    });
  }

  /* ═══════════════════════════════════════════
     SCROLL REVEAL
  ═══════════════════════════════════════════ */
  var obs = new IntersectionObserver(function(entries){
    entries.forEach(function(e){ if (e.isIntersecting){ e.target.style.opacity='1'; e.target.style.transform='translateY(0)'; }});
  }, { threshold: 0.06 });

  document.querySelectorAll('.problem-card,.how-step,.why-card,.service-pill,.why-strip-item').forEach(function(el){
    el.style.opacity='0'; el.style.transform='translateY(10px)';
    el.style.transition='opacity 0.4s ease, transform 0.4s ease';
    obs.observe(el);
  });

});
</script>

<!-- ═══════════════════════════════════════════
     FIREBASE — Auth + Firestore + Analytics
═══════════════════════════════════════════ -->
<script type="module">
  import { initializeApp }                                          from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
  import { getAnalytics }                                           from "https://www.gstatic.com/firebasejs/10.8.1/firebase-analytics.js";
  import { getFirestore, collection, addDoc, query, where, getDocs, orderBy } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";
  import {
    getAuth,
    createUserWithEmailAndPassword,
    signInWithEmailAndPassword,
    signInWithPopup,
    GoogleAuthProvider,
    onAuthStateChanged,
    signOut,
    sendPasswordResetEmail
  } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-auth.js";

  const firebaseConfig = {
    apiKey:            "AIzaSyCJlo2i_MsotnrCJ9VnnXsZidGKospvw2k",
    authDomain:        "thruver-3de75.firebaseapp.com",
    projectId:         "thruver-3de75",
    storageBucket:     "thruver-3de75.firebasestorage.app",
    messagingSenderId: "31613785682",
    appId:             "1:31613785682:web:10158e532742050689318b",
    measurementId:     "G-NPFGT5G82D"
  };

  const app            = initializeApp(firebaseConfig);
  const analytics      = getAnalytics(app);
  const db             = getFirestore(app);
  const auth           = getAuth(app);
  const googleProvider = new GoogleAuthProvider();

  window.db                   = db;
  window.auth                 = auth;
  window.fbCollection         = collection;
  window.fbAddDoc             = addDoc;
  window.fbQuery              = query;
  window.fbWhere              = where;
  window.fbGetDocs            = getDocs;
  window.fbOrderBy            = orderBy;
  window.fbCreateUser         = createUserWithEmailAndPassword;
  window.fbSignIn             = signInWithEmailAndPassword;
  window.fbSignInWithPopup    = signInWithPopup;
  window.fbGoogleProvider     = googleProvider;
  window.fbSignOut            = signOut;
  window.fbOnAuthStateChanged    = onAuthStateChanged;
  window.fbSendPasswordReset     = sendPasswordResetEmail;

  onAuthStateChanged(auth, function(user) {
    if (user) {
      window.currentUser = user;
      if (typeof window.onUserLoggedIn === 'function') window.onUserLoggedIn(user);
    } else {
      window.currentUser = null;
      if (typeof window.onUserLoggedOut === 'function') window.onUserLoggedOut();
    }
  });

  console.log("🔥 Firebase Auth + Firestore conectado a Thruver!");
</script>
</body>
</html>
